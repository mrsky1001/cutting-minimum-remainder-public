var nn=Object.defineProperty;var sn=(t,e,n)=>e in t?nn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var z=(t,e,n)=>(sn(t,typeof e!="symbol"?e+"":e,n),n);import{S as Oe,i as He,s as We,e as Ot,b as we,G as Pe,h as v,C as Ht,E as ft,F as Wt,k as y,l as E,W as Xt,P as rn,a2 as ht,a as N,m as I,c as B,n as m,X as d,a3 as Gt,K as on,L as Ve,Q as an,R as Mt,q as L,r as j,u as ln,w as fe,a4 as he,y as te,z as ne,A as ie,a5 as de,g as Y,d as M,B as se,T as cn,f as un,a0 as fn,o as hn,v as dn}from"../chunks/index.6d77475c.js";import{c as Qe}from"../chunks/Indicator.svelte_svelte_type_style_lang.e2c519f7.js";function mn(t){let e,n,a,s=[t[11],{class:n=Qe(t[5],t[3],t[4],t[8],t[10].class)},{src:a=t[1]},{srcset:t[2]},{alt:t[7]}],i={};for(let o=0;o<s.length;o+=1)i=ft(i,s[o]);return{c(){e=y("img"),this.h()},l(o){e=E(o,"IMG",{class:!0,src:!0,srcset:!0,alt:!0}),this.h()},h(){Xt(e,i)},m(o,l){we(o,e,l)},p(o,l){Xt(e,i=rn(s,[l&2048&&o[11],l&1336&&n!==(n=Qe(o[5],o[3],o[4],o[8],o[10].class))&&{class:n},l&2&&!ht(e.src,a=o[1])&&{src:a},l&4&&{srcset:o[2]},l&128&&{alt:o[7]}]))},d(o){o&&v(e)}}}function gn(t){let e,n,a,s,i,o;return{c(){e=y("figure"),n=y("img"),i=N(),o=y("figcaption"),this.h()},l(l){e=E(l,"FIGURE",{class:!0});var r=I(e);n=E(r,"IMG",{class:!0,src:!0,srcset:!0,alt:!0}),i=B(r),o=E(r,"FIGCAPTION",{class:!0});var w=I(o);w.forEach(v),r.forEach(v),this.h()},h(){m(n,"class",a=Qe(t[5],t[3],t[4],t[8],t[10].class)),ht(n.src,s=t[1])||m(n,"src",s),m(n,"srcset",t[2]),m(n,"alt",t[7]),m(o,"class",t[9]),m(e,"class",t[6])},m(l,r){we(l,e,r),d(e,n),d(e,i),d(e,o),o.innerHTML=t[0]},p(l,r){r&1336&&a!==(a=Qe(l[5],l[3],l[4],l[8],l[10].class))&&m(n,"class",a),r&2&&!ht(n.src,s=l[1])&&m(n,"src",s),r&4&&m(n,"srcset",l[2]),r&128&&m(n,"alt",l[7]),r&1&&(o.innerHTML=l[0]),r&512&&m(o,"class",l[9]),r&64&&m(e,"class",l[6])},d(l){l&&v(e)}}}function wn(t){let e;function n(i,o){return i[0]?gn:mn}let a=n(t),s=a(t);return{c(){s.c(),e=Ot()},l(i){s.l(i),e=Ot()},m(i,o){s.m(i,o),we(i,e,o)},p(i,[o]){a===(a=n(i))&&s?s.p(i,o):(s.d(1),s=a(i),s&&(s.c(),s.m(e.parentNode,e)))},i:Pe,o:Pe,d(i){s.d(i),i&&v(e)}}}function _n(t,e,n){const a=["caption","src","srcset","size","alignment","imgClass","figClass","alt","effect","captionClass"];let s=Ht(e,a),{caption:i=void 0}=e,{src:o=void 0}=e,{srcset:l=void 0}=e,{size:r="max-w-full"}=e,{alignment:w=""}=e,{imgClass:g="h-auto"}=e,{figClass:c="max-w-lg"}=e,{alt:f=""}=e,{effect:b=""}=e,{captionClass:h="mt-2 text-sm text-center text-gray-500 dark:text-gray-400"}=e;return t.$$set=u=>{n(10,e=ft(ft({},e),Wt(u))),n(11,s=Ht(e,a)),"caption"in u&&n(0,i=u.caption),"src"in u&&n(1,o=u.src),"srcset"in u&&n(2,l=u.srcset),"size"in u&&n(3,r=u.size),"alignment"in u&&n(4,w=u.alignment),"imgClass"in u&&n(5,g=u.imgClass),"figClass"in u&&n(6,c=u.figClass),"alt"in u&&n(7,f=u.alt),"effect"in u&&n(8,b=u.effect),"captionClass"in u&&n(9,h=u.captionClass)},e=Wt(e),[i,o,l,r,w,g,c,f,b,h,e,s]}class bn extends Oe{constructor(e){super(),He(this,e,_n,wn,We,{caption:0,src:1,srcset:2,size:3,alignment:4,imgClass:5,figClass:6,alt:7,effect:8,captionClass:9})}}class Ae{constructor(e){z(this,"_a",0);z(this,"_b",0);z(this,"_c",0);z(this,"_d",0);z(this,"_h",0);z(this,"_leftDownAngle",0);z(this,"_rightDownAngle",0);this._a=e.a,this._b=e.b??this._b,this._c=e.c,this._d=e.d??this._d,this._h=e.h,this._leftDownAngle=e.leftDownAngle??this._leftDownAngle,this._rightDownAngle=e.rightDownAngle??this._rightDownAngle}changeBothLength(e){this.a=e,this.c=e}get a(){return this._a}set a(e){this._a=Number(e)}get b(){return this._b}set b(e){this._b=Number(e)}get c(){return this._c}set c(e){this._c=Number(e)}get d(){return this._d}set d(e){this._d=Number(e)}get h(){return this._h}set h(e){this._h=Number(e)}get leftDownAngle(){return this._leftDownAngle}set leftDownAngle(e){this._leftDownAngle=Number(e)}get rightDownAngle(){return this._rightDownAngle}set rightDownAngle(e){this._rightDownAngle=Number(e)}}class qe{constructor(e){z(this,"name");z(this,"size");this.name=e.name,this.size=e.size}get square(){return this.size.h*((this.size.a+this.size.c)/2)}}class Ue{constructor(e){z(this,"blank");z(this,"_volume");this.blank=new qe(e.blank),this._volume=e.volume}get volume(){return this._volume}set volume(e){this._volume=Number(e)}}const pn="_app/immutable/assets/workPiece.321ca12f.png";function vn(t){let e,n,a;return{c(){e=y("input"),this.h()},l(s){e=E(s,"INPUT",{id:!0,type:!0,name:!0,placeholder:!0,class:!0}),this.h()},h(){m(e,"id",t[1]),m(e,"type","text"),m(e,"name",t[1]),e.required=t[3],m(e,"placeholder",t[2]),m(e,"class","bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:bg-[white] focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500")},m(s,i){we(s,e,i),Gt(e,t[0]),n||(a=[on(t[5].call(null,e)),Ve(e,"input",t[7]),Ve(e,"change",function(){an(t[4]?t[8]:null)&&(t[4]?t[8]:null).apply(this,arguments)})],n=!0)},p(s,[i]){t=s,i&2&&m(e,"id",t[1]),i&2&&m(e,"name",t[1]),i&8&&(e.required=t[3]),i&4&&m(e,"placeholder",t[2]),i&1&&e.value!==t[0]&&Gt(e,t[0])},i:Pe,o:Pe,d(s){s&&v(e),n=!1,Mt(a)}}}function Cn(t,e,n){let{id:a=""}=e,{placeholder:s=""}=e,{type:i="text"}=e,{required:o=!1}=e,{value:l}=e,{onChange:r=void 0}=e;const w=f=>{f.type=i};function g(){l=this.value,n(0,l)}const c=f=>r(f.target.value);return t.$$set=f=>{"id"in f&&n(1,a=f.id),"placeholder"in f&&n(2,s=f.placeholder),"type"in f&&n(6,i=f.type),"required"in f&&n(3,o=f.required),"value"in f&&n(0,l=f.value),"onChange"in f&&n(4,r=f.onChange)},[l,a,s,o,r,w,i,g,c]}class Be extends Oe{constructor(e){super(),He(this,e,Cn,vn,We,{id:1,placeholder:2,type:6,required:3,value:0,onChange:4})}}const kn=(t,e,n)=>{const a=[],s=[],i=e.map(r=>r.blank.square+n),o=Math.min(...i),l=(r,w,g,c)=>{for(let f=r;f<w.length;f++){const b=w[f].blank.square+n,h=g-b;c.push(w[f].blank),h>=o?l(f,w,h,c):h<o&&h>=0&&a.push([...c]),c.pop()}};return l(0,e,t,s),a};class Zt{constructor(e){z(this,"head",0);z(this,"body",[]);z(this,"tail",0);e&&(this.head=e.head,this.body=[...e.body],this.tail=e.tail)}}const yn=(t,e)=>{const n=[];return e.forEach(a=>{const s=new Zt;s.head=a.blank.square,t.forEach(i=>{s.body.push(i.filter(o=>o.square===a.blank.square).length)}),s.tail=a.volume,n.push(s)}),n},En=t=>{const e=t.map(s=>new Zt(s)),n=t.map(()=>0),a=(s,i)=>(i[s]=-1,i);return t.forEach((s,i)=>{const o=s.body.concat(a(i,[...n]));e[i].body=o.map(l=>l*-1),e[i].tail*=-1}),e};function dt(t,e=!1){const n=[],a=t[0].body.length,s=()=>{let i="V |";for(let o=1;o<=a;o++)i+=` X${o} `;return i+="| P",i};return n.push(s()),t.forEach(i=>{let o=`${i.head.toFixed(3)} |`;i.body.forEach(l=>{o+=l>-1?` ${l}  `:`${l}  `}),o+=e?`= ${i.tail}`:`>= ${i.tail}`,n.push(o)}),n}const ge=t=>{const n=[];let a="|  c  |  b  | ";t.rows[0].rowCoefficients.forEach((l,r)=>{a+=` X${r+1} `}),n.push(a),t.rows.forEach(l=>{const r=l.b.toFixed(2);let w=l.b>=0?`| X${l.basisIndex+1} | ${r} | `:`| X${l.basisIndex+1} | ${r} | `;l.rowCoefficients.forEach(g=>{const c=g.toFixed(2);w+=g>-1?` ${c} `:`${c} `}),n.push(w)});const s=t.rowF;let o=`| F  | ${s.b.toFixed(2)} | `;return s.rowCoefficients.forEach(l=>{const r=l.toFixed(2);o+=l>-1?` ${r} `:`${r} `}),n.push(o),n};function In(t,e){const s=[`Площадь не обрезанной заготовки: (${t.size.a} * ${t.size.h}) = ${t.square.toFixed(3)} мм²`,"Имя | Площадь мм²| Объем"];return e.forEach(i=>{const o=`${i.blank.name} | ${i.blank.square.toFixed(3)} | ${i.volume}`;s.push(o)}),s}function Ut(t,e,n,a,s=!1){const o=[];o.push("===> Результаты вычисления задачи поиска решения оптимального раскроя"),o.push(`
===> Исходные данные`),o.push(`Площадь сырья для раскроя: ${e.square.toFixed(3)} мм² =  ${(e.square/1e3).toFixed(3)} м²`),o.push("Заказ:"),n.forEach((f,b)=>{o.push(`N${b+1}. Площадь обреза: ${f.blank.square.toFixed(3)} мм² =  ${(f.blank.square/1e3).toFixed(3)} м²; Количество: ${f.volume}`)}),o.push(`
===> Варианты раскроя изделия исходя из начальных условий (матрица).`),o.push("X - варианты раскроя."),o.push("V - площадь обреза."),o.push("Пересечение V/X -  количество распилов длины V по отношению к длине сырья для раскроя."),dt(a).forEach(f=>o.push(f)),o.push(`
===> Оптимальный раскрой материала`);let l=0,r=0;const w=a[0].body.length-1,g=s?0:1;t.rows.forEach(f=>{if(f.basisIndex<=w&&f.b>0){const b=`Количество распилов варианта X${f.basisIndex+1}: ${f.b.toFixed(g)} шт.`;o.push(b),l+=f.b,a.forEach(h=>{const u=h.body[f.basisIndex];u&&(r+=f.b*u*h.head)})}});const c=l*e.square;return o.push(`
Количество заготовок для распила: ${l.toFixed(g)} шт.`),o.push(`Полезная площадь распилов: ${r.toFixed(3)} мм²  = ${(r/1e3).toFixed(3)} м²`),o.push(`Общая площадь требуемых заготовок для распилов: ${c.toFixed(3)} мм² =  ${(c/1e3).toFixed(3)} м²`),o.push(`Остатки: ${(c-r).toFixed(3)} мм² = ${((c-r)/1e3).toFixed(3)} м²`),o}class gt{constructor(e){z(this,"basisIndex",0);z(this,"rowCoefficients",[]);z(this,"b",0);e&&(this.basisIndex=e.basisIndex,this.rowCoefficients=[...e.rowCoefficients],this.b=e.b)}}class mt{constructor(e){z(this,"rowCoefficients",[]);z(this,"b",0);e&&(this.rowCoefficients=[...e.rowCoefficients],this.b=e.b)}}class me{constructor(e){z(this,"rows",[]);z(this,"rowF",new mt);e&&(this.rowF=new mt(e.rowF),this.rows=e.rows.map(n=>new gt(n)))}}const xn=t=>{const e=new me,n=[];for(let a=t.length;a>0;a--)n.push(t[0].body.length-a);return n.forEach((a,s)=>{const i=t[s],o=new gt({basisIndex:a,rowCoefficients:i.body,b:i.tail});e.rows.push(o)}),e.rowF=new mt({b:0,rowCoefficients:[]}),t[0].body.forEach((a,s)=>{const i=n.includes(s);e.rowF.rowCoefficients.push(i?0:1)}),e},wt=(t,e)=>{const n=e.rowIndex,a=e.colIndex,s=new me(t);s.rows[n].basisIndex=a;const i=t.rows[n],o=i.rowCoefficients,l=o[a];t.rows.forEach((g,c)=>{const f=s.rows[c];if(c!==n){const b=g.rowCoefficients[a],h=i.b;f.b=g.b-b*h/l,f.rowCoefficients=g.rowCoefficients.map((u,k)=>{if(k===a)return 0;{const x=i.rowCoefficients[k];return u-b*x/l}})}else f.b=g.b/l,f.rowCoefficients=g.rowCoefficients.map(b=>b/l)});const r=s.rowF,w=t.rowF.rowCoefficients[a];return r.b=t.rowF.b-i.b*w/l,t.rowF.rowCoefficients.forEach((g,c)=>{c!==a?r.rowCoefficients[c]=g-o[c]*w/l:r.rowCoefficients[c]=0}),s};function Fn(t,e){const n=(l,r=!0)=>{const w=b=>{let h=0;const u=b.rows;return u.forEach((k,x)=>{if(r&&k.b<0){const D=u[h].b>=0?0:u[h].b*-1;h=k.b*-1>D?x:h}else if(!r){const D=u[h].b>=0?u[h].b:u[h].b*-1;h=(k.b>=0?k.b:k.b*-1)>D?x:h}}),h},g=(b,h)=>{const u=h.rows[b].rowCoefficients;let k=0;return u.forEach((x,D)=>{const R=u[k]>=0?u[k]:u[k]*-1;k=(x>=0?x:x*-1)>R?D:k}),k},c=w(l),f=g(c,l);return{rowIndex:c,colIndex:f}},a=l=>![...l.rows].filter(r=>r.b<0).length;let s=1,i=new me(t),o=a(i);for(;!o;){e.push(`
===> Начало итерации N${s}`),e.push(`
===> Этап 2. Шаг 1. Исходная таблица`),e.push(...ge(i)),e.push(`
===> Этап 2. Шаг 2. Проверка свободных членов на допустимость решения`),e.push(`Все свободные члены >= 0 ? Ответ:${o}`);const l=n(i);e.push(`
===> Этап 2. Шаг 3. Поиск ведущей строки и столбца`),e.push(`Строка: ${l.rowIndex}, столбец: ${l.colIndex}`),i=wt(i,l),e.push(`
===> Этап 2. Шаг 4. Расчет новой симплекс таблицы `),e.push(...ge(i)),e.push(`
===> Конец итерации N${s}`),o=a(i),s++}return i}function Dn(t,e){const n=(l,r=!0)=>{const w=(b,h)=>{let u=0;return h.forEach((k,x)=>{const D=k.b/k.rowCoefficients[b];if(D>=0){const R=h[u].b/h[u].rowCoefficients[b];u=D<R||R<0?x:u}}),u},c=(b=>{let h=0;return b.forEach((u,k)=>{if(r&&u<0){const x=b[h]*-1;h=u*-1>x?k:h}else if(!r){const x=b[h]>=0?b[h]:b[h]*-1;h=(u>=0?u:u*-1)>x?k:h}}),h})(l.rowF.rowCoefficients);return{rowIndex:w(c,l.rows),colIndex:c}},a=l=>![...l.rowF.rowCoefficients].filter(r=>r<0).length;let s=1,i=new me(t),o=a(i);for(;!o;){e.push(`
===> Начало итерации N${s}`),e.push(`
===> Этап 3. Шаг 1. Исходная таблица`),e.push(...ge(i)),e.push(`
===> Этап 3. Шаг 2. Проверка коэффициентов функции F на допустимость решения.`),e.push(`Все коэффициентов >= 0 ? Ответ:${o}`);const l=n(i);e.push(`
===> Этап 3. Шаг 3. Поиск ведущей строки и столбца для коэффициентов функции F`),e.push(`Строка: ${l.rowIndex}, столбец: ${l.colIndex}`),i=wt(i,l),e.push(`
===> Этап 3. Шаг 4. Расчет новой симплекс таблицы `),e.push(...ge(i)),e.push(`
===> Конец итерации N${s}`),o=a(i),s++}return i}function Sn(t,e){const n=g=>!g.rows.filter(c=>+c.b.toFixed(2)%1!==0).length,a=(g,c=2)=>{const f=new me(g);return f.rows.forEach(b=>{b.b=Number(b.b.toFixed(c)),b.rowCoefficients=b.rowCoefficients.map(h=>Number(h.toFixed(c)))}),f.rowF.rowCoefficients=f.rowF.rowCoefficients.map(b=>Number(b.toFixed(c))),f},s=g=>{const c=u=>{let k=0,x=0;return u.rows.forEach((D,R)=>{const p=D.b%1;p>k&&(k=p,x=R)}),e.push(`Максимальная дробная часть:${k}`),e.push(`Индекс максимальной дробной части:${x}`),x},f=u=>{const k=u%1;return u>=0?-k:k<0?-1-k:k},b=c(g),h=new gt(g.rows[b]);return h.b=f(h.b),h.rowCoefficients=[...h.rowCoefficients.map(u=>f(u)),1],h},i=g=>{const c=(f,b)=>{let h=0;return b.forEach((u,k)=>{const x=f/u;if(x>0){const D=u/b[h];h=x<D||D<0?k:h}}),h};return{rowIndex:r.rows.length-1,colIndex:c(g.b,g.rowCoefficients)}},o=(g,c)=>{const f=h=>{const u=new me(h);return u.rows.forEach(k=>k.rowCoefficients.push(0)),u.rowF.rowCoefficients.push(0),u},b=new me(g);return r=f(r),b.rows.push(c),b};let l=1,r=new me(t),w=n(r);for(e.push(`
===> Этап 4. Шаг 0. Проверка свободных членов на целочисленность.`),e.push(`Все свободные члены b целые ? Ответ:${w}`),r=a(r);!w;){e.push(`
===> Начало итерации N${l}`),e.push(`
===> Этап 4. Шаг 1. Исходная таблица`),e.push(...ge(r)),e.push(`
===> Этап 4. Шаг 2. Формирование нового ограничения`);const g=s(r);r=o(r,g),e.push(...ge(r)),e.push(`
===> Этап 4. Шаг 3. Поиск ведущей строки и столбца`);const c=i(g);e.push(`
===> Этап 4. Шаг 4. Расчет новой симплекс таблицы `),r=a(wt(r,c)),e.push(...ge(r)),e.push(`
===> Этап 4. Шаг 4. Проверка свободных членов на целочисленность.`),w=n(r),e.push(`Все свободные члены b целые ? Ответ: ${w}`),e.push(`
===> Конец итерации N${l}`),l++}return r}const Kt=t=>{const e=t.allowanceSawing*2*t.rawWorkPiece.size.h,n=[];n.push(`
===> Этап 0. Подготовка данных и коэффициентов `),n.push(`Припуск распила: ${t.allowanceSawing}`),n.push(`Площадь допуска распила: ${e}`),n.push(`
Таблица заготовок и их параметров`),n.push(...In(t.rawWorkPiece,t.listOrders));const a=kn(t.rawWorkPiece.square,t.listOrders,e);n.push(`
===> Этап 0. Шаг 1. Варианты раскроя изделия исходя из начальных условий.`),n.push(`Количество комбинаций: ${a.length}`),n.push(`
===> Этап 1. Переход к канонической форме задачи линейного программирования путем введения неотрицательных дополнительных балансовых переменных.`);const s=yn(a,t.listOrders);n.push(`
===> Этап 1. Шаг 1. Получение матрицы коэффициентов`),n.push(...dt(s));const i=En(s);n.push(`
===> Этап 1. Шаг 2. Переход к канонической форме задачи линейного программирования путем введения неотрицательных дополнительных балансовых переменных.`),n.push(...dt(i,!0)),n.push(`
===> Этап 2.  Проверка симплекс таблицы на допустимость решения. Расчет новой симплекс таблицы. `),n.push(`
===> Этап 2. Шаг 0. Инициализация симплекс таблицы`);const o=xn(i),l=Fn(o,n);n.push(`
===> Этап 3. Основной алгоритм решения задачи ЛП симплекс-методом. Расчет новой симплекс таблицы. `);const r=Dn(l,n);n.push(...ge(r)),n.push(...Ut(r,t.rawWorkPiece,t.listOrders,s).map(g=>`
${g}`)),n.push(`
===> Этап 4. Алгоритм поиска целочисленного решения ЗЛП методом Гомори `);const w=Sn(r,n);return n.push(...Ut(w,t.rawWorkPiece,t.listOrders,s,!0).map(g=>`
${g}`)),{listLogMessages:n,cuttingCombinations:a}};function Tn(t){let e,n;return{c(){e=y("label"),n=L(t[1]),this.h()},l(a){e=E(a,"LABEL",{for:!0,class:!0});var s=I(e);n=j(s,t[1]),s.forEach(v),this.h()},h(){m(e,"for",t[0]),m(e,"class","block mb-2 text-sm font-medium text-gray-900 dark:text-white")},m(a,s){we(a,e,s),d(e,n)},p(a,[s]){s&2&&ln(n,a[1]),s&1&&m(e,"for",a[0])},i:Pe,o:Pe,d(a){a&&v(e)}}}function zn(t,e,n){let{forName:a}=e,{text:s}=e;return t.$$set=i=>{"forName"in i&&n(0,a=i.forName),"text"in i&&n(1,s=i.text)},[a,s]}class qn extends Oe{constructor(e){super(),He(this,e,zn,Tn,We,{forName:0,text:1})}}function Pn(t){let e,n,a,s,i;e=new qn({props:{forName:t[1],text:t[6]}});function o(r){t[7](r)}let l={id:t[1],type:t[3],placeholder:t[2],required:t[4],onChange:t[5]};return t[0]!==void 0&&(l.value=t[0]),a=new Be({props:l}),fe.push(()=>he(a,"value",o)),{c(){te(e.$$.fragment),n=N(),te(a.$$.fragment)},l(r){ne(e.$$.fragment,r),n=B(r),ne(a.$$.fragment,r)},m(r,w){ie(e,r,w),we(r,n,w),ie(a,r,w),i=!0},p(r,[w]){const g={};w&2&&(g.forName=r[1]),w&64&&(g.text=r[6]),e.$set(g);const c={};w&2&&(c.id=r[1]),w&8&&(c.type=r[3]),w&4&&(c.placeholder=r[2]),w&16&&(c.required=r[4]),w&32&&(c.onChange=r[5]),!s&&w&1&&(s=!0,c.value=r[0],de(()=>s=!1)),a.$set(c)},i(r){i||(Y(e.$$.fragment,r),Y(a.$$.fragment,r),i=!0)},o(r){M(e.$$.fragment,r),M(a.$$.fragment,r),i=!1},d(r){se(e,r),r&&v(n),se(a,r)}}}function Rn(t,e,n){let{id:a=""}=e,{placeholder:s=""}=e,{type:i="text"}=e,{required:o=!1}=e,{value:l}=e,{onChange:r=void 0}=e,{label:w=""}=e;function g(c){l=c,n(0,l)}return t.$$set=c=>{"id"in c&&n(1,a=c.id),"placeholder"in c&&n(2,s=c.placeholder),"type"in c&&n(3,i=c.type),"required"in c&&n(4,o=c.required),"value"in c&&n(0,l=c.value),"onChange"in c&&n(5,r=c.onChange),"label"in c&&n(6,w=c.label)},[l,a,s,i,o,r,w,g]}class Ke extends Oe{constructor(e){super(),He(this,e,Rn,Pn,We,{id:1,placeholder:2,type:3,required:4,value:0,onChange:5,label:6})}}class Qt{constructor(e){z(this,"originalWidth");z(this,"originalHeight");z(this,"_name");z(this,"_x");z(this,"_y");z(this,"_w");z(this,"_h");z(this,"_color");this._name=e.name,this.originalWidth=e.w,this.originalHeight=e.h,this._x=e.x/5,this._y=e.y/2,this._w=e.w/5,this._h=e.h/2,this._color=e.color}get name(){return this._name}set name(e){this._name=e}get x(){return this._x}set x(e){this._x=e}get y(){return this._y}set y(e){this._y=e}get w(){return this._w}set w(e){this._w=e}get h(){return this._h}set h(e){this._h=e}get color(){return this._color}set color(e){this._color=e}}function Yt(t,e,n){const a=t.slice();return a[17]=e[n],a[18]=e,a[19]=n,a}function Jt(t){let e,n,a=t[19]+1+"",s,i,o,l,r,w,g,c,f,b,h,u,k,x,D,R,p,S,P;function re(_){t[10](_,t[17])}let U={type:"text",id:"namePiece",placeholder:"Наименования детали..."};t[17].blank.name!==void 0&&(U.value=t[17].blank.name),l=new Be({props:U}),fe.push(()=>he(l,"value",re));function H(_){t[11](_,t[17])}let q={type:"number",id:"lengthAPiece",placeholder:"Длина верхнего основания детали..."};t[17].blank.size.a!==void 0&&(q.value=t[17].blank.size.a),c=new Be({props:q}),fe.push(()=>he(c,"value",H));function F(_){t[12](_,t[17])}let O={type:"number",id:"lengthCPiece",placeholder:"Длина нижнего основания детали..."};t[17].blank.size.c!==void 0&&(O.value=t[17].blank.size.c),u=new Be({props:O}),fe.push(()=>he(u,"value",F));function $(_){t[13](_,t[17])}let Q={type:"number",id:"volumePiece",placeholder:"Количество деталей данного типа..."};return t[17].volume!==void 0&&(Q.value=t[17].volume),R=new Be({props:Q}),fe.push(()=>he(R,"value",$)),{c(){e=y("tr"),n=y("th"),s=L(a),i=N(),o=y("td"),te(l.$$.fragment),w=N(),g=y("td"),te(c.$$.fragment),b=N(),h=y("td"),te(u.$$.fragment),x=N(),D=y("td"),te(R.$$.fragment),S=N(),this.h()},l(_){e=E(_,"TR",{class:!0});var T=I(e);n=E(T,"TH",{scope:!0,class:!0});var K=I(n);s=j(K,a),K.forEach(v),i=B(T),o=E(T,"TD",{class:!0});var G=I(o);ne(l.$$.fragment,G),G.forEach(v),w=B(T),g=E(T,"TD",{class:!0});var Z=I(g);ne(c.$$.fragment,Z),Z.forEach(v),b=B(T),h=E(T,"TD",{class:!0});var le=I(h);ne(u.$$.fragment,le),le.forEach(v),x=B(T),D=E(T,"TD",{class:!0});var Ie=I(D);ne(R.$$.fragment,Ie),Ie.forEach(v),S=B(T),T.forEach(v),this.h()},h(){m(n,"scope","row"),m(n,"class","px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white"),m(o,"class","px-6 py-4"),m(g,"class","px-6 py-4"),m(h,"class","px-6 py-4"),m(D,"class","px-6 py-4"),m(e,"class","bg-white border-b dark:bg-gray-700 dark:border-gray-600 hover:bg-[gray]/5 dark:hover:bg-gray-600")},m(_,T){we(_,e,T),d(e,n),d(n,s),d(e,i),d(e,o),ie(l,o,null),d(e,w),d(e,g),ie(c,g,null),d(e,b),d(e,h),ie(u,h,null),d(e,x),d(e,D),ie(R,D,null),d(e,S),P=!0},p(_,T){t=_;const K={};!r&&T&4&&(r=!0,K.value=t[17].blank.name,de(()=>r=!1)),l.$set(K);const G={};!f&&T&4&&(f=!0,G.value=t[17].blank.size.a,de(()=>f=!1)),c.$set(G);const Z={};!k&&T&4&&(k=!0,Z.value=t[17].blank.size.c,de(()=>k=!1)),u.$set(Z);const le={};!p&&T&4&&(p=!0,le.value=t[17].volume,de(()=>p=!1)),R.$set(le)},i(_){P||(Y(l.$$.fragment,_),Y(c.$$.fragment,_),Y(u.$$.fragment,_),Y(R.$$.fragment,_),P=!0)},o(_){M(l.$$.fragment,_),M(c.$$.fragment,_),M(u.$$.fragment,_),M(R.$$.fragment,_),P=!1},d(_){_&&v(e),se(l),se(c),se(u),se(R)}}}function An(t){let e,n,a,s,i,o,l,r,w,g,c,f,b,h,u,k,x,D,R,p,S,P,re,U,H,q,F,O,$,Q,_,T,K,G,Z,le,Ie,ce,xe,J,_e,Ye,Je,be,Me,Ze,pe,Le,je,ve,$e,et,Ce,tt,nt,Fe,it,ke,st,rt,De,ot,Se,at,lt,ee,Xe,ct,_t;function Lt(C){t[6](C)}let bt={label:"Имя",id:"nameWorkPiece",type:"text",placeholder:"Имя исходной заготовки...",required:!0};t[1].name!==void 0&&(bt.value=t[1].name),h=new Ke({props:bt}),fe.push(()=>he(h,"value",Lt)),D=new Ke({props:{label:"Длина (a), мм.",id:"lengthRawPiece",type:"number",placeholder:"Длина исходной заготовки(в миллиметрах)...",value:t[1].size.a,onChange:t[7],required:!0}});function jt(C){t[8](C)}let pt={label:"Ширина (h), мм.",id:"widthRawPiece",type:"number",placeholder:"Ширина исходной заготовки (в миллиметрах)...",required:!0};t[1].size.h!==void 0&&(pt.value=t[1].size.h),S=new Ke({props:pt}),fe.push(()=>he(S,"value",jt));function $t(C){t[9](C)}let vt={label:"Припуск, мм.",id:"allowanceSawing",type:"number",placeholder:"Припуск при распиле (в миллиметрах)...",required:!0};t[0]!==void 0&&(vt.value=t[0]),H=new Ke({props:vt}),fe.push(()=>he(H,"value",$t)),O=new bn({props:{src:pn,class:"max-h-72 m-auto"}});let ye=t[2],A=[];for(let C=0;C<ye.length;C+=1)A[C]=Jt(Yt(t,ye,C));const en=C=>M(A[C],1,1,()=>{A[C]=null});return{c(){e=y("div"),n=y("div"),a=y("main"),s=y("div"),i=y("div"),o=y("section"),l=y("div"),r=y("h2"),w=L("Параметры исходной заготовки для распила"),g=N(),c=y("form"),f=y("div"),b=y("div"),te(h.$$.fragment),k=N(),x=y("div"),te(D.$$.fragment),R=N(),p=y("div"),te(S.$$.fragment),re=N(),U=y("div"),te(H.$$.fragment),F=N(),te(O.$$.fragment),$=N(),Q=y("div"),_=y("button"),T=L("Запустить расчет"),K=N(),G=y("div"),Z=y("h2"),le=L("Список требуемых деталей из заказа"),Ie=N(),ce=y("table"),xe=y("thead"),J=y("tr"),_e=y("th"),Ye=L("№"),Je=N(),be=y("th"),Me=L("Имя"),Ze=N(),pe=y("th"),Le=L("Длина верхнего основания (a), мм."),je=N(),ve=y("th"),$e=L("Длина нижнего основания (c), мм."),et=N(),Ce=y("th"),tt=L("Количество, шт."),nt=N(),Fe=y("tbody");for(let C=0;C<A.length;C+=1)A[C].c();it=N(),ke=y("button"),st=L("+ Добавить деталь"),rt=N(),De=y("div"),ot=N(),Se=y("h2"),at=L("Результаты вычислений"),lt=N(),ee=y("div"),this.h()},l(C){e=E(C,"DIV",{class:!0});var V=I(e);n=E(V,"DIV",{class:!0});var oe=I(n);a=E(oe,"MAIN",{class:!0});var Te=I(a);s=E(Te,"DIV",{class:!0});var Re=I(s);i=E(Re,"DIV",{class:!0});var X=I(i);o=E(X,"SECTION",{class:!0});var W=I(o);l=E(W,"DIV",{class:!0});var Ee=I(l);r=E(Ee,"H2",{class:!0});var Ct=I(r);w=j(Ct,"Параметры исходной заготовки для распила"),Ct.forEach(v),g=B(Ee),c=E(Ee,"FORM",{action:!0});var kt=I(c);f=E(kt,"DIV",{class:!0});var ue=I(f);b=E(ue,"DIV",{class:!0});var yt=I(b);ne(h.$$.fragment,yt),yt.forEach(v),k=B(ue),x=E(ue,"DIV",{class:!0});var Et=I(x);ne(D.$$.fragment,Et),Et.forEach(v),R=B(ue),p=E(ue,"DIV",{class:!0});var It=I(p);ne(S.$$.fragment,It),It.forEach(v),re=B(ue),U=E(ue,"DIV",{class:!0});var xt=I(U);ne(H.$$.fragment,xt),xt.forEach(v),ue.forEach(v),kt.forEach(v),Ee.forEach(v),W.forEach(v),F=B(X),ne(O.$$.fragment,X),$=B(X),Q=E(X,"DIV",{class:!0});var Ft=I(Q);_=E(Ft,"BUTTON",{class:!0});var Dt=I(_);T=j(Dt,"Запустить расчет"),Dt.forEach(v),Ft.forEach(v),K=B(X),G=E(X,"DIV",{class:!0});var ze=I(G);Z=E(ze,"H2",{class:!0});var St=I(Z);le=j(St,"Список требуемых деталей из заказа"),St.forEach(v),Ie=B(ze),ce=E(ze,"TABLE",{class:!0});var Ge=I(ce);xe=E(Ge,"THEAD",{class:!0});var Tt=I(xe);J=E(Tt,"TR",{});var ae=I(J);_e=E(ae,"TH",{scope:!0,class:!0});var zt=I(_e);Ye=j(zt,"№"),zt.forEach(v),Je=B(ae),be=E(ae,"TH",{scope:!0,class:!0});var qt=I(be);Me=j(qt,"Имя"),qt.forEach(v),Ze=B(ae),pe=E(ae,"TH",{scope:!0,class:!0});var Pt=I(pe);Le=j(Pt,"Длина верхнего основания (a), мм."),Pt.forEach(v),je=B(ae),ve=E(ae,"TH",{scope:!0,class:!0});var Rt=I(ve);$e=j(Rt,"Длина нижнего основания (c), мм."),Rt.forEach(v),et=B(ae),Ce=E(ae,"TH",{scope:!0,class:!0});var At=I(Ce);tt=j(At,"Количество, шт."),At.forEach(v),ae.forEach(v),Tt.forEach(v),nt=B(Ge),Fe=E(Ge,"TBODY",{});var Nt=I(Fe);for(let ut=0;ut<A.length;ut+=1)A[ut].l(Nt);Nt.forEach(v),Ge.forEach(v),it=B(ze),ke=E(ze,"BUTTON",{class:!0});var Bt=I(ke);st=j(Bt,"+ Добавить деталь"),Bt.forEach(v),ze.forEach(v),rt=B(X),De=E(X,"DIV",{id:!0,class:!0});var tn=I(De);tn.forEach(v),ot=B(X),Se=E(X,"H2",{class:!0});var Vt=I(Se);at=j(Vt,"Результаты вычислений"),Vt.forEach(v),lt=B(X),ee=E(X,"DIV",{id:!0,contenteditable:!0}),I(ee).forEach(v),X.forEach(v),Re.forEach(v),Te.forEach(v),oe.forEach(v),V.forEach(v),this.h()},h(){m(r,"class","mb-4 text-xl font-bold text-gray-900 dark:text-white"),m(b,"class","sm:col-span-2"),m(x,"class","w-full"),m(p,"class","w-full"),m(U,"class","w-full"),m(f,"class","grid gap-4 sm:grid-cols-2 sm:gap-6"),m(c,"action","#"),m(l,"class","py-8 px-4 mx-auto max-w-2xl lg:py-16"),m(o,"class","bg-white dark:bg-gray-900"),m(_,"class","inline-flex items-center px-5 py-2.5 mt-4 sm:mt-6 text-sm font-medium text-center float-right text-white bg-primary-600 rounded-lg focus:ring-4 focus:ring-primary-200 dark:focus:ring-primary-900 hover:bg-primary-700"),m(Q,"class","relative overflow-x-auto"),m(Z,"class","mb-4 text-xl font-bold text-gray-900 dark:text-white"),m(_e,"scope","col"),m(_e,"class","px-6 py-3"),m(be,"scope","col"),m(be,"class","px-6 py-3"),m(pe,"scope","col"),m(pe,"class","px-6 py-3"),m(ve,"scope","col"),m(ve,"class","px-6 py-3"),m(Ce,"scope","col"),m(Ce,"class","px-6 py-3"),m(xe,"class","text-xs text-gray-600 uppercase bg-gray-50 dark:bg-gray-600 dark:text-gray-400"),m(ce,"class","w-full text-sm text-left text-gray-500 dark:text-gray-400"),m(ke,"class","inline-flex items-center px-5 py-2.5 mt-4 sm:mt-6 text-sm font-medium text-center float-right text-white bg-primary-600 rounded-lg focus:ring-4 focus:ring-primary-200 dark:focus:ring-primary-900 hover:bg-primary-700"),m(G,"class","relative overflow-x-auto"),m(De,"id","containerWorkPieceCanvases"),m(De,"class","flex flex-col"),m(Se,"class","mb-4 text-xl font-bold text-gray-900 dark:text-white"),m(ee,"id","log"),m(ee,"contenteditable","true"),t[3]===void 0&&cn(()=>t[14].call(ee)),m(i,"class","flex-auto max-w-8xl min-w-0 pt-6 lg:px-8 lg:pt-8 pb:12 xl:pb-24 lg:pb-16"),m(s,"class","flex w-full"),m(a,"class","flex-auto w-full min-w-0 lg:static lg:max-h-full lg:overflow-visible"),m(n,"class","lg:flex"),m(e,"class","w-full px-4 mx-auto max-w-8xl")},m(C,V){we(C,e,V),d(e,n),d(n,a),d(a,s),d(s,i),d(i,o),d(o,l),d(l,r),d(r,w),d(l,g),d(l,c),d(c,f),d(f,b),ie(h,b,null),d(f,k),d(f,x),ie(D,x,null),d(f,R),d(f,p),ie(S,p,null),d(f,re),d(f,U),ie(H,U,null),d(i,F),ie(O,i,null),d(i,$),d(i,Q),d(Q,_),d(_,T),d(i,K),d(i,G),d(G,Z),d(Z,le),d(G,Ie),d(G,ce),d(ce,xe),d(xe,J),d(J,_e),d(_e,Ye),d(J,Je),d(J,be),d(be,Me),d(J,Ze),d(J,pe),d(pe,Le),d(J,je),d(J,ve),d(ve,$e),d(J,et),d(J,Ce),d(Ce,tt),d(ce,nt),d(ce,Fe);for(let oe=0;oe<A.length;oe+=1)A[oe]&&A[oe].m(Fe,null);d(G,it),d(G,ke),d(ke,st),d(i,rt),d(i,De),d(i,ot),d(i,Se),d(Se,at),d(i,lt),d(i,ee),t[3]!==void 0&&(ee.innerHTML=t[3]),Xe=!0,ct||(_t=[Ve(_,"click",t[5]),Ve(ke,"click",t[4]),Ve(ee,"input",t[14])],ct=!0)},p(C,[V]){const oe={};!u&&V&2&&(u=!0,oe.value=C[1].name,de(()=>u=!1)),h.$set(oe);const Te={};V&2&&(Te.value=C[1].size.a),V&2&&(Te.onChange=C[7]),D.$set(Te);const Re={};!P&&V&2&&(P=!0,Re.value=C[1].size.h,de(()=>P=!1)),S.$set(Re);const X={};if(!q&&V&1&&(q=!0,X.value=C[0],de(()=>q=!1)),H.$set(X),V&4){ye=C[2];let W;for(W=0;W<ye.length;W+=1){const Ee=Yt(C,ye,W);A[W]?(A[W].p(Ee,V),Y(A[W],1)):(A[W]=Jt(Ee),A[W].c(),Y(A[W],1),A[W].m(Fe,null))}for(dn(),W=ye.length;W<A.length;W+=1)en(W);un()}V&8&&C[3]!==ee.innerHTML&&(ee.innerHTML=C[3])},i(C){if(!Xe){Y(h.$$.fragment,C),Y(D.$$.fragment,C),Y(S.$$.fragment,C),Y(H.$$.fragment,C),Y(O.$$.fragment,C);for(let V=0;V<ye.length;V+=1)Y(A[V]);Xe=!0}},o(C){M(h.$$.fragment,C),M(D.$$.fragment,C),M(S.$$.fragment,C),M(H.$$.fragment,C),M(O.$$.fragment,C),A=A.filter(Boolean);for(let V=0;V<A.length;V+=1)M(A[V]);Xe=!1},d(C){C&&v(e),se(h),se(D),se(S),se(H),se(O),fn(A,C),ct=!1,Mt(_t)}}}let Ne=200;function Nn(t,e,n){let a=0,s=new qe({name:"Основная",size:new Ae({a:5e3,c:5e3,h:Ne})}),i=[new Ue({blank:new qe({name:"Деталь №1",size:new Ae({a:1500,c:1500,h:Ne})}),volume:10}),new Ue({blank:new qe({name:"Деталь №2",size:new Ae({a:2300,c:2300,h:Ne})}),volume:20}),new Ue({blank:new qe({name:"Деталь №3",size:new Ae({a:3500,c:3500,h:Ne})}),volume:30})],o;const l=()=>{const p=new Ue({blank:new qe({name:`Деталь №${i.length+1}`,size:new Ae({a:0,c:0,h:Ne})}),volume:0});n(2,i=[...i,p])};let r="";const w=()=>{if(a>=0&&s.name.length>0&&s.size.a&&s.size.c&&s.size.h){const p=[],S=P=>P.volume>0&&P.blank.size.a>0&&P.blank.size.c>0;i.forEach(P=>{P.blank.size.h=s.size.h,S(P)&&p.push(P)}),n(2,i=p),p.length?(console.log({allowanceSawing:a,rawWorkPiece:s,listOrders:p}),o=Kt({allowanceSawing:a,rawWorkPiece:s,listOrders:p}),n(3,r=o.listLogMessages.map(P=>P.includes("===>")?`<p class='mt-2 font-bold'>${P}</p>`:`<p '>${P}</p>`).join(""))):alert("Внимание! Нет валидных деталей для выполнения алгоритма. Скорее всего не все поля были заполнены.")}else alert("Внимание! Не корректно заполнены параметры исходной заготовки.")},g=(p,S,P)=>{const re=(q,F)=>{F.setLineDash([5,3]),F.textBaseline="bottom",F.lineDashOffset=1,F.beginPath(),F.moveTo(0,q.h);const O=20,$=(_,T)=>{F.lineTo(0,_.h-T),F.lineTo(_.w,_.h-T),F.lineTo(_.w,_.h);const K={x:_.w/2,y:_.h-T-10};F.fillText(` ${_.originalWidth} мм`,K.x,K.y),F.stroke()},Q=(_,T)=>{F.lineTo(_.w+T,_.h),F.lineTo(_.w+T,_.h*2),F.lineTo(_.w,_.h*2),F.textBaseline="top",F.rotate(90*Math.PI/180);const K={x:_.h+_.h/4,y:-(_.w+T+20)};F.fillText(` ${_.originalHeight} мм`,K.x,K.y),F.rotate(-(90*Math.PI)/180),F.stroke()};$(q,O),Q(q,O)},U=(q,F)=>{F.strokeStyle="#B70A02",F.strokeRect(q.x,q.y,q.w,q.h),F.fillStyle=q.color,F.fillRect(q.x,q.y,q.w,q.h),F.fillStyle="black",F.textBaseline="middle";const O={x:q.x+q.w/3,y:q.h+q.h/2};F.fillText(` Деталь "${q.name}" длиной ${q.originalWidth} мм`,O.x,O.y)},H=document.getElementById("containerWorkPieceCanvases");console.log(P),P.forEach((q,F)=>{const O=H.appendChild(document.createElement("canvas")),$=O.getContext("2d");O.width=1100,O.height=200*(F+1);const Q=new Qt({name:"container",x:0,y:S,w:5e3,h:S,color:"#DADADA"});re(Q,$),U(Q,$),q.forEach(_=>{U(_,$)})})};hn(()=>{o=Kt({allowanceSawing:a,rawWorkPiece:s,listOrders:i}),console.log(o);const p=[];o.cuttingCombinations.forEach(S=>{let P=0,re=0;const U=[];S.forEach(H=>{U.push(new Qt({name:H.name,x:P,y:H.size.h+re,w:H.size.a,h:H.size.h,color:"#d1ffd8"})),P+=H.size.a}),p.push(U),re+=200}),g("workPiece",s.size.h,p)});function c(p){t.$$.not_equal(s.name,p)&&(s.name=p,n(1,s))}const f=p=>s.size.changeBothLength(p);function b(p){t.$$.not_equal(s.size.h,p)&&(s.size.h=p,n(1,s))}function h(p){a=p,n(0,a)}function u(p,S){t.$$.not_equal(S.blank.name,p)&&(S.blank.name=p,n(2,i))}function k(p,S){t.$$.not_equal(S.blank.size.a,p)&&(S.blank.size.a=p,n(2,i))}function x(p,S){t.$$.not_equal(S.blank.size.c,p)&&(S.blank.size.c=p,n(2,i))}function D(p,S){t.$$.not_equal(S.volume,p)&&(S.volume=p,n(2,i))}function R(){r=this.innerHTML,n(3,r)}return[a,s,i,r,l,w,c,f,b,h,u,k,x,D,R]}class Hn extends Oe{constructor(e){super(),He(this,e,Nn,An,We,{})}}export{Hn as component};
