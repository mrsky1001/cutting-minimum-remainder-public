var $n=Object.defineProperty;var jn=(t,e,n)=>e in t?$n(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var x=(t,e,n)=>(jn(t,typeof e!="symbol"?e+"":e,n),n);import{S as ft,i as dt,s as gt,e as Sn,b as le,G as Ue,h as b,C as An,E as Xt,F as Fn,k as v,l as z,W as kn,P as ei,a4 as Ut,a as T,m as y,c as R,n as f,X as g,I as ti,q as ee,Z as En,r as te,_ as In,L as ht,u as Mn,M as ni,N as ii,O as si,g as U,d as Y,K as oi,R as Xn,w as ge,a5 as me,y as K,z as W,A as Z,a6 as pe,B as J,f as ai,a0 as li,j as ri,o as ci,T as Un,v as ui}from"../chunks/index.8d332a97.js";import{c as Et,T as Tn,t as Rn,a as Bn}from"../chunks/all-toast.store.097cde36.js";function hi(t){let e,n,a,i=[t[11],{class:n=Et(t[5],t[3],t[4],t[8],t[10].class)},{src:a=t[1]},{srcset:t[2]},{alt:t[7]}],s={};for(let l=0;l<i.length;l+=1)s=Xt(s,i[l]);return{c(){e=v("img"),this.h()},l(l){e=z(l,"IMG",{class:!0,src:!0,srcset:!0,alt:!0}),this.h()},h(){kn(e,s)},m(l,o){le(l,e,o)},p(l,o){kn(e,s=ei(i,[o&2048&&l[11],o&1336&&n!==(n=Et(l[5],l[3],l[4],l[8],l[10].class))&&{class:n},o&2&&!Ut(e.src,a=l[1])&&{src:a},o&4&&{srcset:l[2]},o&128&&{alt:l[7]}]))},d(l){l&&b(e)}}}function fi(t){let e,n,a,i,s,l;return{c(){e=v("figure"),n=v("img"),s=T(),l=v("figcaption"),this.h()},l(o){e=z(o,"FIGURE",{class:!0});var r=y(e);n=z(r,"IMG",{class:!0,src:!0,srcset:!0,alt:!0}),s=R(r),l=z(r,"FIGCAPTION",{class:!0});var w=y(l);w.forEach(b),r.forEach(b),this.h()},h(){f(n,"class",a=Et(t[5],t[3],t[4],t[8],t[10].class)),Ut(n.src,i=t[1])||f(n,"src",i),f(n,"srcset",t[2]),f(n,"alt",t[7]),f(l,"class",t[9]),f(e,"class",t[6])},m(o,r){le(o,e,r),g(e,n),g(e,s),g(e,l),l.innerHTML=t[0]},p(o,r){r&1336&&a!==(a=Et(o[5],o[3],o[4],o[8],o[10].class))&&f(n,"class",a),r&2&&!Ut(n.src,i=o[1])&&f(n,"src",i),r&4&&f(n,"srcset",o[2]),r&128&&f(n,"alt",o[7]),r&1&&(l.innerHTML=o[0]),r&512&&f(l,"class",o[9]),r&64&&f(e,"class",o[6])},d(o){o&&b(e)}}}function di(t){let e;function n(s,l){return s[0]?fi:hi}let a=n(t),i=a(t);return{c(){i.c(),e=Sn()},l(s){i.l(s),e=Sn()},m(s,l){i.m(s,l),le(s,e,l)},p(s,[l]){a===(a=n(s))&&i?i.p(s,l):(i.d(1),i=a(s),i&&(i.c(),i.m(e.parentNode,e)))},i:Ue,o:Ue,d(s){i.d(s),s&&b(e)}}}function gi(t,e,n){const a=["caption","src","srcset","size","alignment","imgClass","figClass","alt","effect","captionClass"];let i=An(e,a),{caption:s=void 0}=e,{src:l=void 0}=e,{srcset:o=void 0}=e,{size:r="max-w-full"}=e,{alignment:w=""}=e,{imgClass:d="h-auto"}=e,{figClass:c="max-w-lg"}=e,{alt:m=""}=e,{effect:h=""}=e,{captionClass:p="mt-2 text-sm text-center text-gray-500 dark:text-gray-400"}=e;return t.$$set=u=>{n(10,e=Xt(Xt({},e),Fn(u))),n(11,i=An(e,a)),"caption"in u&&n(0,s=u.caption),"src"in u&&n(1,l=u.src),"srcset"in u&&n(2,o=u.srcset),"size"in u&&n(3,r=u.size),"alignment"in u&&n(4,w=u.alignment),"imgClass"in u&&n(5,d=u.imgClass),"figClass"in u&&n(6,c=u.figClass),"alt"in u&&n(7,m=u.alt),"effect"in u&&n(8,h=u.effect),"captionClass"in u&&n(9,p=u.captionClass)},e=Fn(e),[s,l,o,r,w,d,c,m,h,p,e,i]}class mi extends ft{constructor(e){super(),dt(this,e,gi,di,gt,{caption:0,src:1,srcset:2,size:3,alignment:4,imgClass:5,figClass:6,alt:7,effect:8,captionClass:9})}}class Me{constructor(e){x(this,"_a",0);x(this,"_b",0);x(this,"_c",0);x(this,"_d",0);x(this,"_h",0);x(this,"_leftDownAngle",0);x(this,"_leftDownAngleRad",0);x(this,"_rightDownAngle",0);x(this,"_rightDownAngleRad",0);x(this,"minLength");x(this,"maxLength");x(this,"minAngle");x(this,"maxAngle");x(this,"_fractionDigits",3);this._a=e.a,this._b=e.b??this._b,this._c=e.c,this._d=e.d??this._d,this._h=e.h,this._leftDownAngle=e.leftDownAngle??this._leftDownAngle,this._rightDownAngle=e.rightDownAngle??this._rightDownAngle,this.minLength=e.minLength??10,this.maxLength=e.maxLength,this.minAngle=e.minAngle??10,this.maxAngle=e.maxAngle??162,this._leftDownAngleRad=this._toRadians(this._leftDownAngle),this._rightDownAngleRad=this._toRadians(this._rightDownAngle),this.recalculation()}changeBothBases(e){this.a=e,this.c=e}_toRadians(e){return parseFloat((e*(Math.PI/180)).toFixed(3))}_toDegree(e){return parseFloat((e*180/Math.PI).toFixed(3))}recalculation(){this._h&&(this._leftDownAngleRad&&(this.d=this._h/Math.sin(this._leftDownAngleRad)),this._a&&this._c&&(this._rightDownAngleRad=Math.abs(Math.atan(this._h/this.differenceBases)),this._rightDownAngle=this.differenceBases>0?180-this._toDegree(this._rightDownAngleRad):this._toDegree(this._rightDownAngleRad)),this._rightDownAngleRad&&(this.b=this._h/Math.sin(this._rightDownAngleRad)))}get differenceBases(){const e=this._a,n=this._c,a=this._leftDownAngle>=90?this.segmentLeftUp:-1*this.segmentLeftUp;return e-a-n}get segmentLeftUp(){const e=Math.abs(this._leftDownAngle-90);return Math.sqrt(this._h*this._h+this._d*this._d-2*this._h*this._d*Math.cos(this._toRadians(e)))}flipHorizontal(){const e={leftDownAngle:this.leftDownAngle,rightDownAngle:this.rightDownAngle,a:this.a,b:this.b,c:this.c,d:this.d};this._leftDownAngle=e.rightDownAngle,this._rightDownAngle=e.leftDownAngle,this._a=e.a,this._c=e.c,this._b=e.d,this._d=e.b}flipVertical(){const e={leftDownAngle:this.leftDownAngle,rightDownAngle:this.rightDownAngle,a:this.a,b:this.b,c:this.c,d:this.d};this._leftDownAngle=180-e.leftDownAngle,this._rightDownAngle=180-e.rightDownAngle,this._a=e.c,this._c=e.a,this._b=e.b,this._d=e.d}get isRect(){return this.a===this.c&&this.leftDownAngle===90&&this.rightDownAngle===90}get perimeter(){return this._a+this._b+this._c+this._d}get a(){return this._a}set a(e){this._a=parseFloat(Number(e).toFixed(this._fractionDigits)),this.recalculation()}get b(){return this._b}set b(e){this._b=parseFloat(Number(e).toFixed(this._fractionDigits))}get c(){return this._c}set c(e){this._c=parseFloat(Number(e).toFixed(this._fractionDigits)),this.recalculation()}get d(){return this._d}set d(e){this._d=parseFloat(Number(e).toFixed(this._fractionDigits))}get h(){return this._h}set h(e){this._h=parseFloat(Number(e).toFixed(this._fractionDigits))}get leftDownAngle(){return parseFloat(Number(this._leftDownAngle).toFixed(0))}set leftDownAngle(e){this._leftDownAngle=parseFloat(Number(e).toFixed(this._fractionDigits)),this._leftDownAngleRad=this._toRadians(this._leftDownAngle),this.recalculation()}get rightDownAngle(){return parseFloat(Number(this._rightDownAngle).toFixed(0))}set rightDownAngle(e){this._rightDownAngle=parseFloat(Number(e).toFixed(this._fractionDigits)),this._rightDownAngleRad=this._toRadians(this._rightDownAngle)}}function Oe(t,e=3){return parseFloat((t*1e-6).toFixed(e))}function Zt(t,e,n){return(t+e)/2*n}class be{constructor(e){x(this,"id");x(this,"name");x(this,"size");x(this,"_isHorizontalFlipped",!1);x(this,"_isVerticalFlipped",!1);this.id=e.id,this.name=e.name,this.size=new Me(e.size)}get isRect(){return this.size.isRect}get square(){return Zt(this.size.a,this.size.c,this.size.h)}get isHorizontalFlipped(){return this._isHorizontalFlipped}get isVerticalFlipped(){return this._isVerticalFlipped}flipHorizontal(){this.size.flipHorizontal(),this._isHorizontalFlipped=!0}flipVertical(){this.size.flipVertical(),this._isVerticalFlipped=!0}}let ne=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((e,n)=>(n&=63,n<36?e+=n.toString(36):n<62?e+=(n-26).toString(36).toUpperCase():n>62?e+="-":e+="_",e),"");const pi=async({params:t})=>{const a=new be({id:ne(),name:"Основная",size:new Me({a:5e3,c:5e3,h:800,maxLength:4900})}),i=[{id:ne(),blank:new be({id:ne(),name:"Д. №1",size:new Me({a:500,c:1e3,leftDownAngle:90,rightDownAngle:0,h:800,maxLength:a.size.maxLength})}),volume:10},{id:ne(),blank:new be({id:ne(),name:"Д. №5",size:new Me({a:1e3,c:500,leftDownAngle:45,h:800,maxLength:a.size.maxLength})}),volume:30},{id:ne(),blank:new be({id:ne(),name:"Деталь №4",size:new Me({a:500,c:500,leftDownAngle:90,h:800,maxLength:a.size.maxLength})}),volume:50}];return{restrictedParams:new Promise(s=>s({stockSawing:5})),rawWorkPiece:new Promise(s=>s(a)),rawOrders:new Promise(s=>s(i))}},Qi=Object.freeze(Object.defineProperty({__proto__:null,load:pi},Symbol.toStringTag,{value:"Module"}));function wi(t){let e,n,a,i,s,l,o,r,w,d,c,m,h,p,u,_,D;const S=t[5].default,k=ti(S,t,t[4],null);return{c(){e=v("div"),n=v("h2"),a=v("button"),i=v("span"),s=ee(t[1]),l=T(),o=En("svg"),r=En("path"),d=T(),c=v("div"),m=v("div"),k&&k.c(),this.h()},l(F){e=z(F,"DIV",{id:!0,"data-accordion":!0});var I=y(e);n=z(I,"H2",{id:!0});var M=y(n);a=z(M,"BUTTON",{type:!0,class:!0,"data-accordion-target":!0,"aria-expanded":!0,"aria-controls":!0});var G=y(a);i=z(G,"SPAN",{});var ie=y(i);s=te(ie,t[1]),ie.forEach(b),l=R(G),o=In(G,"svg",{"data-accordion-icon":!0,class:!0,"aria-hidden":!0,xmlns:!0,fill:!0,viewBox:!0});var Q=y(o);r=In(Q,"path",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),y(r).forEach(b),Q.forEach(b),G.forEach(b),M.forEach(b),d=R(I),c=z(I,"DIV",{id:!0,class:!0,"aria-labelledby":!0});var se=y(c);m=z(se,"DIV",{class:!0});var $=y(m);k&&k.l($),$.forEach(b),se.forEach(b),I.forEach(b),this.h()},h(){f(r,"stroke","currentColor"),f(r,"stroke-linecap","round"),f(r,"stroke-linejoin","round"),f(r,"stroke-width","2"),f(r,"d","M9 5 5 1 1 5"),f(o,"data-accordion-icon",""),f(o,"class",w="w-3 h-3 "+(t[0]?"rotate-180":"")+" shrink-0"),f(o,"aria-hidden","true"),f(o,"xmlns","http://www.w3.org/2000/svg"),f(o,"fill","none"),f(o,"viewBox","0 0 10 6"),f(a,"type","button"),f(a,"class",t[2]),f(a,"data-accordion-target","#accordion-collapse-body-1"),f(a,"aria-expanded","true"),f(a,"aria-controls","accordion-collapse-body-1"),f(n,"id","accordion-collapse-heading-1"),f(m,"class","p-5 border border-gray-200 dark:border-gray-700 dark:bg-gray-900"),f(c,"id","accordion-collapse-body-1"),f(c,"class",h=t[0]?"":"hidden"),f(c,"aria-labelledby","accordion-collapse-heading-1"),f(e,"id","accordion-collapse"),f(e,"data-accordion",p=t[0]?"open":"collapse")},m(F,I){le(F,e,I),g(e,n),g(n,a),g(a,i),g(i,s),g(a,l),g(a,o),g(o,r),g(e,d),g(e,c),g(c,m),k&&k.m(m,null),u=!0,_||(D=ht(a,"click",t[6]),_=!0)},p(F,[I]){(!u||I&2)&&Mn(s,F[1]),(!u||I&1&&w!==(w="w-3 h-3 "+(F[0]?"rotate-180":"")+" shrink-0"))&&f(o,"class",w),(!u||I&4)&&f(a,"class",F[2]),k&&k.p&&(!u||I&16)&&ni(k,S,F,F[4],u?si(S,F[4],I,null):ii(F[4]),null),(!u||I&1&&h!==(h=F[0]?"":"hidden"))&&f(c,"class",h),(!u||I&1&&p!==(p=F[0]?"open":"collapse"))&&f(e,"data-accordion",p)},i(F){u||(U(k,F),u=!0)},o(F){Y(k,F),u=!1},d(F){F&&b(e),k&&k.d(F),_=!1,D()}}}function _i(t,e,n){let{$$slots:a={},$$scope:i}=e,{title:s=""}=e,{isOpen:l=!1}=e;const o=()=>n(0,l=!l);let r="flex items-center justify-between w-full p-5 font-medium text-left border border-gray-200 rounded-xl focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-800 dark:border-gray-700 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800";const w=()=>o();return t.$$set=d=>{"title"in d&&n(1,s=d.title),"isOpen"in d&&n(0,l=d.isOpen),"$$scope"in d&&n(4,i=d.$$scope)},t.$$.update=()=>{if(t.$$.dirty&5){const d="rounded-xl",c="rounded-t-xl",m=" bg-gray-100";l?(n(2,r=r.replace(d,c)),n(2,r+=m)):(n(2,r=r.replace(c,d)),n(2,r=r.replace(m,"")))}},[l,s,r,o,i,a,w]}class At extends ft{constructor(e){super(),dt(this,e,_i,wi,gt,{title:1,isOpen:0})}}class Vn{constructor(e){x(this,"id");x(this,"blank");x(this,"_volume");x(this,"minVolume");x(this,"maxVolume");this.id=e.id,this.blank=new be(e.blank),this._volume=e.volume,this.minVolume=e.minVolume??1,this.maxVolume=e.maxVolume??100}get volume(){return this._volume}set volume(e){this._volume=Number(e)}}const bi="_app/immutable/assets/workPiece.ba374e36.png";function vi(t){let e,n,a;return{c(){e=v("input"),this.h()},l(i){e=z(i,"INPUT",{id:!0,type:!0,name:!0,placeholder:!0,class:!0}),this.h()},h(){f(e,"id",t[1]),f(e,"type","text"),f(e,"name",t[1]),e.disabled=t[3],e.required=t[4],f(e,"placeholder",t[2]),e.value=t[0],f(e,"class",t[5])},m(i,s){le(i,e,s),n||(a=[oi(t[6].call(null,e)),ht(e,"change",t[11])],n=!0)},p(i,[s]){s&2&&f(e,"id",i[1]),s&2&&f(e,"name",i[1]),s&8&&(e.disabled=i[3]),s&16&&(e.required=i[4]),s&4&&f(e,"placeholder",i[2]),s&1&&e.value!==i[0]&&(e.value=i[0]),s&32&&f(e,"class",i[5])},i:Ue,o:Ue,d(i){i&&b(e),n=!1,Xn(a)}}}function zi(t,e,n){let{id:a=""}=e,{placeholder:i=""}=e,{type:s="text"}=e,{disabled:l=!1}=e,{numSettings:o}=e,{required:r=!1}=e,{value:w}=e,{onChange:d=void 0}=e;const c=u=>{u.type=s};let m=`border border-gray-300 text-gray-900 text-sm rounded-lg focus:bg-[white] focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700
                                                         dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500`;l&&(m+=" bg-gray-100");const h=(u,_)=>{let D=s==="number"?Number(_):_;const S=" text-red-800 border border-red-300";(F=>!(o&&(o.min&&F<o.min||o.max&&F>o.max)))(D)?n(0,w=D):m.includes(S)||(n(5,m+=S),setTimeout(()=>{n(5,m=m.replace(S,""))},1e3)),u.value=w},p=u=>h(u.target,u.target.value);return t.$$set=u=>{"id"in u&&n(1,a=u.id),"placeholder"in u&&n(2,i=u.placeholder),"type"in u&&n(8,s=u.type),"disabled"in u&&n(3,l=u.disabled),"numSettings"in u&&n(9,o=u.numSettings),"required"in u&&n(4,r=u.required),"value"in u&&n(0,w=u.value),"onChange"in u&&n(10,d=u.onChange)},[w,a,i,l,r,m,c,h,s,o,d,p]}class Re extends ft{constructor(e){super(),dt(this,e,zi,vi,gt,{id:1,placeholder:2,type:8,disabled:3,numSettings:9,required:4,value:0,onChange:10})}}class Ye{constructor(e){x(this,"id");x(this,"name");x(this,"type");x(this,"_square");x(this,"_p1");x(this,"_p2");x(this,"_p3");x(this,"_p4");x(this,"_wP1P2");x(this,"_wP2P3");x(this,"_wP3P4");x(this,"_wP4P1");x(this,"_h");x(this,"_colorBody");x(this,"_colorContour");x(this,"_colorTextLegend");x(this,"_colorContourLegend");x(this,"isHorizontalFlipped");x(this,"isVerticalFlipped");x(this,"isShowBodyText");x(this,"isShowBaseContour");x(this,"isShowSideContour");x(this,"baseSpace");x(this,"sideSpace");x(this,"halfYBoard");x(this,"halfXBoard");x(this,"wDivider");x(this,"hDivider");this.id=e.id,this.name=e.name,this.type=e.type,this._square=e.square,this._p1={x:e.p1.x,y:e.p1.y},this._p2={x:e.p2.x,y:e.p2.y},this._p3={x:e.p3.x,y:e.p3.y},this._p4={x:e.p4.x,y:e.p4.y},this._wP1P2=e.wP1P2,this._wP2P3=e.wP2P3,this._wP3P4=e.wP3P4,this._wP4P1=e.wP4P1,this._h=e.h,this.isHorizontalFlipped=e.isHorizontalFlipped!==void 0?e.isHorizontalFlipped:!1,this.isVerticalFlipped=e.isVerticalFlipped!==void 0?e.isVerticalFlipped:!1,this.isShowBodyText=e.isShowBodyText!==void 0?e.isShowBodyText:!0,this.isShowBaseContour=e.isShowBaseContour!==void 0?e.isShowBaseContour:!0,this.isShowSideContour=e.isShowSideContour!==void 0?e.isShowSideContour:!0,this.baseSpace=e.baseSpace??20,this.sideSpace=e.sideSpace??20,this.halfXBoard=e.halfXBoard??250,this.halfYBoard=e.halfYBoard??50,this.wDivider=e.wDivider??2,this.hDivider=e.hDivider??2,this._colorBody=e.colorBody??"#d1ffd8",this._colorContour=e.colorContour??"#B70A02",this._colorTextLegend=e.colorTextLegend??"black",this._colorContourLegend=e.colorContourLegend??"gray"}get perimeter(){return this._wP1P2+this._wP2P3+this._wP3P4+this._wP4P1}get colorTextLegend(){return this._colorTextLegend}get colorContourLegend(){return this._colorContourLegend}get colorBody(){return this._colorBody}get square(){return this._square}get p1(){return this._p1}get p2(){return this._p2}get p3(){return this._p3}get p4(){return this._p4}get wP1P2(){return this._wP1P2}get wP2P3(){return this._wP2P3}get wP3P4(){return this._wP3P4}get wP4P1(){return this._wP4P1}get h(){return this._h}get colorContour(){return this._colorContourLegend}}const Yt=(t,e,n,a,i)=>{const s=i>0?1:-1;return{x:t-s*Math.sqrt(Math.abs(a*a-(e-n)*(e-n))),y:n}},Ve={REMAINS:"Ост.",STOCK:"п."};function Ft(t,e,n){e&&(t=((d,c)=>{if(d.size.rightDownAngle<90){if(c.size.leftDownAngle>=90){const m=d.size.rightDownAngle+c.size.leftDownAngle;if(c.size.rightDownAngle>=90){const h=d.size.rightDownAngle+c.size.rightDownAngle;(m>=h||h>180)&&m<=180||h<=180&&c.flipHorizontal()}else if(c.size.rightDownAngle<90){const h=d.size.rightDownAngle+180-c.size.rightDownAngle;(m>=h||h>180)&&m<=180||h<=180&&(c.flipHorizontal(),c.flipVertical())}}else if(c.size.leftDownAngle<90){const m=d.size.rightDownAngle+180-c.size.leftDownAngle;if(c.size.rightDownAngle>=90){const h=d.size.rightDownAngle+c.size.rightDownAngle;(m>=h||h>180)&&m<=180?c.flipVertical():h<=180&&c.flipHorizontal()}else if(c.size.rightDownAngle<90){const h=d.size.rightDownAngle+180-c.size.rightDownAngle;(m>=h||h>180)&&m<=180?c.flipVertical():h<=180&&(c.flipHorizontal(),c.flipVertical())}}}else if(d.size.rightDownAngle>90){if(c.size.leftDownAngle>=90){const m=d.size.rightDownAngle+180-c.size.leftDownAngle;if(c.size.rightDownAngle>=90){const h=d.size.rightDownAngle+180-c.size.rightDownAngle;(m>=h||h>180)&&m<=180?c.flipVertical():h<=180&&(c.flipVertical(),c.flipHorizontal())}else if(c.size.rightDownAngle<90){const h=d.size.rightDownAngle+180-c.size.rightDownAngle;(m>=h||h>180)&&m<=180?c.flipVertical():h<=180&&c.flipHorizontal()}}else if(c.size.leftDownAngle<90){const m=d.size.rightDownAngle+c.size.leftDownAngle;if(c.size.rightDownAngle>=90){const h=d.size.rightDownAngle+180-c.size.rightDownAngle;(m>=h||h>180)&&m<=180||h<=180&&(c.flipVertical(),c.flipHorizontal())}else if(c.size.rightDownAngle<90){const h=d.size.rightDownAngle+c.size.rightDownAngle;(m>=h||h>180)&&m<=180||h<=180&&c.flipHorizontal()}}}return c})(e,t));const i=(d,c,m,h,p)=>{const u=d.x-p.x;u>0&&(c.x+=u,m.x+=u,h.x+=u,p.x+=u)},s=n?n.p2.x:0;let l,o,r,w;if(t.size.leftDownAngle<90&&!n)w={x:0,y:t.size.h},l=Yt(w.x,w.y,0,t.size.d,-Math.abs(t.size.differenceBases)),o={x:l.x+t.size.a,y:l.y},r={x:w.x+t.size.c,y:w.y};else{l={x:s,y:0},o={x:l.x+t.size.a,y:0};const d={x:o.x,y:t.size.h};r=t.isRect?d:Yt(o.x,o.y,d.y,t.size.b,t.size.differenceBases),w={x:r.x-t.size.c,y:r.y}}return n&&i(n.p3,l,o,r,w),new Ye({id:ne(),type:"piece",name:t.name,square:t.square,p1:l,p2:o,p3:r,p4:w,wP1P2:t.size.a,wP2P3:t.size.b,wP3P4:t.size.c,wP4P1:t.size.d,h:t.size.h,isHorizontalFlipped:t.isHorizontalFlipped,isVerticalFlipped:t.isVerticalFlipped,colorContourLegend:"gray",colorBody:"#d1ffd8",isShowSideContour:!1,baseSpace:30,halfXBoard:0,halfYBoard:100,wDivider:4.2,hDivider:5})}function yi(t,e){const n=parseFloat(t.perimeter.toFixed(0)),a=parseFloat(e.perimeter.toFixed(0)),i=parseFloat(t.wP1P2.toFixed(0)),s=parseFloat(t.wP2P3.toFixed(0)),l=parseFloat(e.wP1P2.toFixed(0)),o=parseFloat(e.wP3P4.toFixed(0)),r=parseFloat(e.wP4P1.toFixed(0));return n===a&&(i===l||i===o)&&s===r}function xi(t,e,n){const a=new be({id:ne(),name:Ve.STOCK,size:new Me({a:t,c:t,b:n.size.b,d:n.size.b,h:e.h,leftDownAngle:180-n.size.rightDownAngle,rightDownAngle:n.size.rightDownAngle,maxLength:t})}),i={...e.p2},s={x:i.x+a.size.a,y:i.y},l={...e.p3},o={x:l.x+a.size.c,y:l.y};return{piece:a,drawPiece:new Ye({id:ne(),type:"sawing-remain",name:a.name,square:a.square,p1:i,p2:s,p3:o,p4:l,wP1P2:a.size.a,wP2P3:a.size.b,wP3P4:a.size.c,wP4P1:a.size.d,h:a.size.h,colorContourLegend:"gray",colorBody:"lightgray",isShowBodyText:!1,isShowSideContour:!1,baseSpace:5,halfXBoard:0,halfYBoard:100,wDivider:4.2,hDivider:5})}}function Di(t,e,n,a,i){const s=i.wP4P1,l=e.wP2P3,o=180-a.size.leftDownAngle-n.size.rightDownAngle,r=o>0?i.p1.x-e.p2.x+t:i.p4.x-e.p3.x+t,w=s*l*Math.sign(Math.abs(o)),d=new be({id:ne(),name:Ve.STOCK,size:new Me({a:o>0?r:t,c:o>0?t:r,b:s,d:l,h:e.h,leftDownAngle:180-n.size.rightDownAngle,rightDownAngle:180-a.size.leftDownAngle,maxLength:t})}),c={...e.p2},m=o>0?{x:c.x+r,y:c.y}:{x:c.x+t,y:c.y},h={x:e.p3.x,y:d.size.h},p=o>0?{x:h.x+t,y:h.y}:{x:h.x+r,y:h.y},u=new Ye({id:ne(),type:"body-remain",name:Ve.REMAINS,square:w,p1:c,p2:m,p3:p,p4:h,wP1P2:d.size.a,wP2P3:d.size.b,wP3P4:d.size.c,wP4P1:d.size.d,h:d.size.h,colorContourLegend:"gray",colorBody:"lightgray",isShowSideContour:!1,baseSpace:10,halfXBoard:0,halfYBoard:100,wDivider:4.2,hDivider:5});return{piece:d,drawPiece:u}}function Ci(t,e){const n=e.p1.x,a=e.p4.x,i=Zt(n,a,e.h),s={x:0,y:0},l={...e.p1},o={x:0,y:e.h},r={...e.p4},w=new be({id:ne(),name:Ve.REMAINS,size:new Me({a:n,b:e.wP4P1,c:a,d:e.h,h:e.h,leftDownAngle:90,rightDownAngle:180-t.size.leftDownAngle,maxLength:n})}),d=new Ye({id:ne(),type:"start-remain",name:Ve.REMAINS,square:i,p1:s,p2:l,p3:r,p4:o,wP1P2:n,wP2P3:e.wP4P1,wP3P4:a,wP4P1:e.h,h:e.h,colorContourLegend:"gray",colorBody:"lightgray",isShowSideContour:!1,baseSpace:10,halfXBoard:0,halfYBoard:100,wDivider:4.2,hDivider:5});return{piece:w,drawPiece:d}}function Pi(t,e,n){const a=t-n.p2.x,i=t-n.p3.x,s=Zt(a,i,e.size.h),l={...n.p2},o={x:t,y:l.y},r={...n.p3},w={x:t,y:r.y};return new Ye({id:ne(),type:"end-remain",name:Ve.REMAINS,square:s,p1:l,p2:o,p3:w,p4:r,wP1P2:a,wP2P3:n.h,wP3P4:i,wP4P1:e.size.b,h:n.h,colorContourLegend:"gray",colorBody:"lightgray",isShowSideContour:!1,baseSpace:10,halfXBoard:0,halfYBoard:100,wDivider:4.2,hDivider:5})}function Si(t,e,n){const a=(c,m)=>{for(const h of d)if(h.p2.x<=c&&h.p3.x<=m||h.p2.x<=m&&h.p3.x<=c)return!0;return!1};let i,s;const l=(c,m,h)=>{const p=u=>{h.push(u),s=u.piece,i=u.drawPiece};for(let u=c;u<m.length;u++){const _=new be(n[u].blank);let D=Ft(_,s,i);if(s&&i){const I=yi(i,D);if(t&&I){const M=xi(t,i,s);p(M)}else if(!I){const M=Di(t,i,s,_,D);p(M)}D=Ft(_,s,i)}else if(D.p1.x>0||D.p4.x>0){const I=Ci(_,D);p(I),D=Ft(_,s,i)}p({piece:_,drawPiece:D});const S=h[h.length-1].drawPiece,k=e-S.p2.x,F=e-S.p3.x;if(a(k,F))l(u,m,h);else if(k>=0&&F>=0&&s&&i){const I=Pi(e,s,i);r.push([...h.map(M=>new be(M.piece))]),o.push({num:o.length+1,volume:0,combination:[...h.map(M=>new Ye(M.drawPiece)),I]})}h.pop(),h.length>0&&h[h.length-1].drawPiece.type.includes("remain")&&h.pop(),h.length>0?(i=h[h.length-1].drawPiece,s=h[h.length-1].piece):(i=void 0,s=void 0)}},o=[],r=[],w=[],d=n.map(c=>Ft(c.blank));return l(0,d,w),{drawCombinations:o,cuttingCombinations:r}}function qn(t,e,n){const i=[];return e.forEach(s=>{if(s.basisIndex<=t&&s.b>0){const l=parseFloat(s.b.toFixed(0));i.push({num:s.basisIndex+1,volume:l,combination:n[s.basisIndex].combination})}}),i.sort((s,l)=>s.num-l.num)}function Gt(t,e=!1){const n=[],a=t[0].body.length,i=()=>{let s="V |";for(let l=1;l<=a;l++)s+=` X${l} `;return s+="| P",s};return n.push(i()),t.forEach(s=>{let l=`${parseFloat(s.head.toFixed(3))} |`;s.body.forEach(o=>{l+=o>-1?` ${o}  `:`${o}  `}),l+=e?`= ${s.tail}`:`>= ${s.tail}`,n.push(l)}),n}const Be=t=>{const n=[];let a="N |  c  |  b  | ";t.rows[0].rowCoefficients.forEach((o,r)=>{a+=` X${r+1} `}),n.push(a),t.rows.forEach((o,r)=>{const w=parseFloat(o.b.toFixed(2));let d=o.b>=0?`${r+1} | X${o.basisIndex+1} | ${w} | `:`${r+1} | X${o.basisIndex+1} | ${w} | `;o.rowCoefficients.forEach(c=>{const m=parseFloat(c.toFixed(2));d+=c>-1?` ${m} `:`${m} `}),n.push(d)});const i=t.rowF;let l=`| F  | ${parseFloat(i.b.toFixed(2))} | `;return i.rowCoefficients.forEach(o=>{const r=parseFloat(o.toFixed(2));l+=o>-1?` ${r} `:`${r} `}),n.push(l),n};function Ai(t,e){const s=[`Площадь не обрезанной заготовки: (${t.size.a} * ${t.size.h}) = ${parseFloat(t.square.toFixed(3))} мм² = ${Oe(t.square,3)} м²`,"Имя | Площадь мм²| Объем"];return e.forEach(l=>{const o=`${l.blank.name} | ${parseFloat(l.blank.square.toFixed(3))} | ${l.volume}`;s.push(o)}),s}function Hn(t,e,n,a,i=!1){const l=[],o=parseFloat(e.square.toFixed(3));l.push("===> Результаты вычисления задачи поиска решения оптимального раскроя"),l.push(`
===> Исходные данные`),l.push(`Площадь сырья для раскроя: ${o} мм² =  ${Oe(o,3)} м²`),l.push("Заказ:"),n.forEach((_,D)=>{const S=parseFloat(_.blank.square.toFixed(3));l.push(`N${D+1}. Площадь обреза: ${S} мм² =  ${Oe(S,3)} м²; Количество: ${_.volume} шт.`)}),l.push(`
===> Варианты раскроя изделия исходя из начальных условий (матрица).`),l.push("X - варианты раскроя."),l.push("V - площадь обреза."),l.push("Пересечение V/X -  количество распилов длины V по отношению к длине сырья для раскроя."),Gt(a).forEach(_=>l.push(_)),l.push(`
===> Оптимальный раскрой материала`);let r=0,w=0;const d=a[0].body.length-1,c=i?0:1;t.rows.forEach(_=>{if(_.basisIndex<=d&&_.b>0){const D=parseFloat(_.b.toFixed(c)),S=`Количество распилов варианта X${_.basisIndex+1}: ${D} шт.`;l.push(S),r+=_.b,a.forEach(k=>{const F=k.body[_.basisIndex];F&&(w+=_.b*F*k.head)})}});const m=parseFloat((r*e.square).toFixed(3)),h=parseFloat(r.toFixed(c)),p=parseFloat(w.toFixed(3)),u=parseFloat((m-w).toFixed(3));return l.push(`
Количество заготовок для распила: ${h} шт.`),l.push(`Полезная площадь распилов: ${p} мм²  = ${Oe(p,3)} м²`),l.push(`Общая площадь требуемых заготовок для распилов: ${m} мм² =  ${Oe(m,3)} м²`),l.push(`Остатки: ${u} мм² = ${Oe(u,3)} м²`),l}class Yn{constructor(e){x(this,"head",0);x(this,"body",[]);x(this,"tail",0);e&&(this.head=e.head,this.body=[...e.body],this.tail=e.tail)}}const Fi=(t,e)=>{const n=[];return e.forEach(a=>{const i=new Yn;i.head=a.blank.square,t.forEach(s=>{const l=s.filter(o=>o.id===a.blank.id).length;i.body.push(l)}),i.tail=a.volume,n.push(i)}),n},ki=t=>{const e=t.map(i=>new Yn(i)),n=t.map(()=>0),a=(i,s)=>(s[i]=-1,s);return t.forEach((i,s)=>{const l=i.body.concat(a(s,[...n]));e[s].body=l.map(o=>o*-1),e[s].tail*=-1}),e};class Jt{constructor(e){x(this,"basisIndex",0);x(this,"rowCoefficients",[]);x(this,"b",0);e&&(this.basisIndex=e.basisIndex,this.rowCoefficients=[...e.rowCoefficients],this.b=e.b)}}class Kt{constructor(e){x(this,"rowCoefficients",[]);x(this,"b",0);e&&(this.rowCoefficients=[...e.rowCoefficients],this.b=e.b)}}class Xe{constructor(e){x(this,"rows",[]);x(this,"rowF",new Kt);e&&(this.rowF=new Kt(e.rowF),this.rows=e.rows.map(n=>new Jt(n)))}}const Ei=t=>{const e=new Xe,n=[];for(let a=t.length;a>0;a--)n.push(t[0].body.length-a);return n.forEach((a,i)=>{const s=t[i],l=new Jt({basisIndex:a,rowCoefficients:s.body,b:s.tail});e.rows.push(l)}),e.rowF=new Kt({b:0,rowCoefficients:[]}),t[0].body.forEach((a,i)=>{const s=n.includes(i);e.rowF.rowCoefficients.push(s?0:1)}),e},Qt=(t,e)=>{const n=e.rowIndex,a=e.colIndex,i=new Xe(t);i.rows[n].basisIndex=a;const s=t.rows[n],l=s.rowCoefficients,o=l[a];t.rows.forEach((d,c)=>{const m=i.rows[c];if(c!==n){const h=d.rowCoefficients[a],p=s.b;m.b=d.b-h*p/o,m.rowCoefficients=d.rowCoefficients.map((u,_)=>{if(_===a)return 0;{const D=s.rowCoefficients[_];return u-h*D/o}})}else m.b=d.b/o,m.rowCoefficients=d.rowCoefficients.map(h=>h/o)});const r=i.rowF,w=t.rowF.rowCoefficients[a];return r.b=t.rowF.b-s.b*w/o,t.rowF.rowCoefficients.forEach((d,c)=>{c!==a?r.rowCoefficients[c]=d-l[c]*w/o:r.rowCoefficients[c]=0}),i};function Ii(t,e){const n=(o,r=!0)=>{const w=h=>{let p=0;const u=h.rows;return u.forEach((_,D)=>{if(r&&_.b<0){const S=u[p].b>=0?0:u[p].b*-1;p=_.b*-1>S?D:p}else if(!r){const S=u[p].b>=0?u[p].b:u[p].b*-1;p=(_.b>=0?_.b:_.b*-1)>S?D:p}}),p},d=(h,p)=>{const u=p.rows[h].rowCoefficients;let _=0;return u.forEach((D,S)=>{const k=u[_]>=0?u[_]:u[_]*-1;_=(D>=0?D:D*-1)>k?S:_}),_},c=w(o),m=d(c,o);return{rowIndex:c,colIndex:m}},a=o=>![...o.rows].filter(r=>r.b<0).length;let i=1,s=new Xe(t),l=a(s);for(;!l;){e.push(`
===> Начало итерации N${i}`),e.push(`
===> Этап 2. Шаг 1. Исходная таблица`),e.push(...Be(s)),e.push(`
===> Этап 2. Шаг 2. Проверка свободных членов на допустимость решения`),e.push(`Все свободные члены >= 0 ? Ответ:${l}`);const o=n(s);e.push(`
===> Этап 2. Шаг 3. Поиск ведущей строки и столбца`),e.push(`Строка: ${o.rowIndex}, столбец: ${o.colIndex}`),s=Qt(s,o),e.push(`
===> Этап 2. Шаг 4. Расчет новой симплекс таблицы `),e.push(...Be(s)),e.push(`
===> Конец итерации N${i}`),l=a(s),i>30&&(l=!0,e.push(`
===> Внимание! Завершилось после 30 итераций`)),i++}return s}function Ti(t,e){const n=(o,r=!0)=>{const w=(h,p)=>{let u=0;return p.forEach((_,D)=>{const S=_.b/_.rowCoefficients[h];if(S>=0){const k=p[u].b/p[u].rowCoefficients[h];u=S<k||k<0?D:u}}),u},c=(h=>{let p=0;return h.forEach((u,_)=>{if(r&&u<0){const D=h[p]*-1;p=u*-1>D?_:p}else if(!r){const D=h[p]>=0?h[p]:h[p]*-1;p=(u>=0?u:u*-1)>D?_:p}}),p})(o.rowF.rowCoefficients);return{rowIndex:w(c,o.rows),colIndex:c}},a=o=>![...o.rowF.rowCoefficients].filter(r=>r<0).length;let i=1,s=new Xe(t),l=a(s);for(;!l;){e.push(`
===> Начало итерации N${i}`),e.push(`
===> Этап 3. Шаг 1. Исходная таблица`),e.push(...Be(s)),e.push(`
===> Этап 3. Шаг 2. Проверка коэффициентов функции F на допустимость решения.`),e.push(`Все коэффициентов >= 0 ? Ответ:${l}`);const o=n(s);e.push(`
===> Этап 3. Шаг 3. Поиск ведущей строки и столбца для коэффициентов функции F`),e.push(`Строка: ${o.rowIndex}, столбец: ${o.colIndex}`),s=Qt(s,o),e.push(`
===> Этап 3. Шаг 4. Расчет новой симплекс таблицы `),e.push(...Be(s)),e.push(`
===> Конец итерации N${i}`),l=a(s),i++}return s}function Ri(t,e){const n=d=>!d.rows.filter(c=>+c.b.toFixed(2)%1!==0).length,a=(d,c=2)=>{const m=new Xe(d);return m.rows.forEach(h=>{h.b=Number(h.b.toFixed(c)),h.rowCoefficients=h.rowCoefficients.map(p=>Number(p.toFixed(c)))}),m.rowF.rowCoefficients=m.rowF.rowCoefficients.map(h=>Number(h.toFixed(c))),m},i=d=>{const c=u=>{let _=0,D=0;return u.rows.forEach((S,k)=>{const F=S.b%1;F>_&&(_=F,D=k)}),e.push(`Максимальная дробная часть:${_}`),e.push(`Индекс максимальной дробной части:${D}`),D},m=u=>{const _=u%1;return u>=0?-_:_<0?-1-_:_},h=c(d),p=new Jt(d.rows[h]);return p.b=m(p.b),p.rowCoefficients=[...p.rowCoefficients.map(u=>m(u)),1],p},s=d=>{const c=(m,h)=>{let p=0;return h.forEach((u,_)=>{const D=m/u;if(D>0){const S=u/h[p];p=D<S||S<0?_:p}}),p};return{rowIndex:r.rows.length-1,colIndex:c(d.b,d.rowCoefficients)}},l=(d,c)=>{const m=p=>{const u=new Xe(p);return u.rows.forEach(_=>_.rowCoefficients.push(0)),u.rowF.rowCoefficients.push(0),u},h=new Xe(d);return r=m(r),h.rows.push(c),h};let o=1,r=new Xe(t),w=n(r);for(e.push(`
===> Этап 4. Шаг 0. Проверка свободных членов на целочисленность.`),e.push(`Все свободные члены b целые ? Ответ:${w}`),r=a(r);!w;){e.push(`
===> Начало итерации N${o}`),e.push(`
===> Этап 4. Шаг 1. Исходная таблица`),e.push(...Be(r)),e.push(`
===> Этап 4. Шаг 2. Формирование нового ограничения`);const d=i(r);r=l(r,d),e.push(...Be(r));const c=s(d);e.push(`
===> Этап 4. Шаг 3. Поиск ведущей строки и столбца`),e.push(`Строка: ${c.rowIndex}, столбец: ${c.colIndex}`),e.push(`
===> Этап 4. Шаг 4. Расчет новой симплекс таблицы `),r=a(Qt(r,c)),e.push(...Be(r)),e.push(`
===> Этап 4. Шаг 4. Проверка свободных членов на целочисленность.`),w=n(r),e.push(`Все свободные члены b целые ? Ответ: ${w}`),e.push(`
===> Конец итерации N${o}`),o>100&&(w=!0,e.push(`
===> Внимание! Завершилось после 100 итераций`)),o++}return r}const Bi=t=>{const e=t.stockSawing*2*t.rawWorkPiece.size.h,n=[];n.push(`
===> Этап 0. Подготовка данных и коэффициентов `),n.push(`Припуск распила: ${t.stockSawing}`),n.push(`Площадь припуска распила: ${e} мм² = ${Oe(e)} м²`),n.push(`
Таблица заготовок и их параметров`),n.push(...Ai(t.rawWorkPiece,t.listOrders));const a=Si(t.stockSawing,t.rawWorkPiece.size.a,t.listOrders);n.push(`
===> Этап 0. Шаг 1. Варианты раскроя изделия исходя из начальных условий.`),n.push(`Количество комбинаций: ${a.cuttingCombinations.length}`),console.log(a),n.push(`
===> Этап 1. Переход к канонической форме задачи линейного программирования путем введения неотрицательных дополнительных балансовых переменных.`);const i=Fi(a.cuttingCombinations,t.listOrders);n.push(`
===> Этап 1. Шаг 1. Получение матрицы коэффициентов`),n.push(...Gt(i));const s=ki(i);n.push(`
===> Этап 1. Шаг 2. Переход к канонической форме задачи линейного программирования путем введения неотрицательных дополнительных балансовых переменных.`),n.push(...Gt(s,!0)),n.push(`
===> Этап 2.  Проверка симплекс таблицы на допустимость решения. Расчет новой симплекс таблицы. `),n.push(`
===> Этап 2. Шаг 0. Инициализация симплекс таблицы`);const l=Ei(s);n.push(...Be(l));const o=Ii(l,n);n.push(`
===> Этап 3. Основной алгоритм решения задачи ЛП симплекс-методом. Расчет новой симплекс таблицы. `);const r=Ti(o,n);n.push(...Be(r)),n.push(...Hn(r,t.rawWorkPiece,t.listOrders,i).map(c=>`
${c}`)),n.push("[integer]"),n.push(`
===> Этап 4. Алгоритм поиска целочисленного решения ЗЛП методом Гомори `);const w=Ri(r,n);n.push(...Hn(w,t.rawWorkPiece,t.listOrders,i,!0).map(c=>`
${c}`));const d=qn(i[0].body.length-1,w.rows,a.drawCombinations);if(d.length)return{listLogMessages:n,drawCombinations:a.drawCombinations,optimumDrawCombinations:d};{const c=qn(i[0].body.length-1,r.rows,a.drawCombinations),m=n.findIndex(h=>h==="[integer]");return{listLogMessages:n.slice(0,m),drawCombinations:a.drawCombinations,optimumDrawCombinations:c}}};function Vi(t){let e,n;return{c(){e=v("label"),n=ee(t[1]),this.h()},l(a){e=z(a,"LABEL",{for:!0,class:!0});var i=y(e);n=te(i,t[1]),i.forEach(b),this.h()},h(){f(e,"for",t[0]),f(e,"class","block mb-2 text-sm font-medium text-gray-900 dark:text-white")},m(a,i){le(a,e,i),g(e,n)},p(a,[i]){i&2&&Mn(n,a[1]),i&1&&f(e,"for",a[0])},i:Ue,o:Ue,d(a){a&&b(e)}}}function qi(t,e,n){let{forName:a}=e,{text:i}=e;return t.$$set=s=>{"forName"in s&&n(0,a=s.forName),"text"in s&&n(1,i=s.text)},[a,i]}class Hi extends ft{constructor(e){super(),dt(this,e,qi,Vi,gt,{forName:0,text:1})}}function Li(t){let e,n,a,i,s;e=new Hi({props:{forName:t[1],text:t[6]}});function l(r){t[7](r)}let o={id:t[1],type:t[3],placeholder:t[2],required:t[4],onChange:t[5]};return t[0]!==void 0&&(o.value=t[0]),a=new Re({props:o}),ge.push(()=>me(a,"value",l)),{c(){K(e.$$.fragment),n=T(),K(a.$$.fragment)},l(r){W(e.$$.fragment,r),n=R(r),W(a.$$.fragment,r)},m(r,w){Z(e,r,w),le(r,n,w),Z(a,r,w),s=!0},p(r,[w]){const d={};w&2&&(d.forName=r[1]),w&64&&(d.text=r[6]),e.$set(d);const c={};w&2&&(c.id=r[1]),w&8&&(c.type=r[3]),w&4&&(c.placeholder=r[2]),w&16&&(c.required=r[4]),w&32&&(c.onChange=r[5]),!i&&w&1&&(i=!0,c.value=r[0],pe(()=>i=!1)),a.$set(c)},i(r){s||(U(e.$$.fragment,r),U(a.$$.fragment,r),s=!0)},o(r){Y(e.$$.fragment,r),Y(a.$$.fragment,r),s=!1},d(r){J(e,r),r&&b(n),J(a,r)}}}function Ni(t,e,n){let{id:a=""}=e,{placeholder:i=""}=e,{type:s="text"}=e,{required:l=!1}=e,{value:o}=e,{onChange:r=void 0}=e,{label:w=""}=e;function d(c){o=c,n(0,o)}return t.$$set=c=>{"id"in c&&n(1,a=c.id),"placeholder"in c&&n(2,i=c.placeholder),"type"in c&&n(3,s=c.type),"required"in c&&n(4,l=c.required),"value"in c&&n(0,o=c.value),"onChange"in c&&n(5,r=c.onChange),"label"in c&&n(6,w=c.label)},[o,a,i,s,l,r,w,d]}class kt extends ft{constructor(e){super(),dt(this,e,Ni,Li,gt,{id:1,placeholder:2,type:3,required:4,value:0,onChange:5,label:6})}}function Gn(t,e=1230,n=350){const a=t.appendChild(document.createElement("div"));a.className="flex flex-row justify-around items-center";const i=a.appendChild(document.createElement("canvas")),s=i.getContext("2d");return i.width=e,i.height=n,s}function Wt(t,e){const n=l=>l/t.wDivider+t.halfXBoard,a=l=>l/t.hDivider+t.halfYBoard,s=(l,o)=>{o.setLineDash([5,3]),o.textBaseline="bottom",o.lineDashOffset=1,o.strokeStyle=l.colorContourLegend,o.fillStyle=l.colorTextLegend,o.beginPath();const r=(h,p,u,_=0,D=0)=>{o.setLineDash([5,3]),o.beginPath(),o.moveTo(n(h.x),a(h.y)),o.lineTo(n(h.x)+_,a(h.y)+D),o.lineTo(n(p.x)+_,a(p.y)+D),o.lineTo(n(p.x),a(p.y)),o.stroke(),o.closePath()},w=(h,p,u,_=-l.baseSpace)=>{r(h,p,u,0,_);const D=parseFloat(u.toFixed(1)),S=` ${D} мм`,k=_>0?_+15:_-5,F=D>100?S.length:-5,I={x:(n(p.x)+n(h.x))/2-F,y:(a(p.y)+a(h.y))/2+k};o.fillText(S,I.x,I.y)},d=(h,p,u,_=30)=>{r(h,p,u,_);const D=_>0?_*3:_*4,S={x:(n(p.x)+n(h.x))/2+D,y:(a(p.y)+a(h.y))/2};o.fillText(` ${u} мм`,S.x,S.y)},c=(h,p,u)=>{w(h,p,u,l.baseSpace)},m=(h,p,u)=>{d(h,p,u,-l.baseSpace)};l.isShowBaseContour&&(w(l.p1,l.p2,l.wP1P2),c(l.p3,l.p4,l.wP3P4)),l.isShowSideContour&&(d(l.p2,l.p3,l.wP2P3),m(l.p4,l.p1,l.wP4P1))};if(e.font="8pt Arial",e.strokeStyle=t.colorContour,e.fillStyle=t.colorBody,e.beginPath(),e.setLineDash([]),e.moveTo(n(t.p1.x),a(t.p1.y)),e.lineTo(n(t.p1.x),a(t.p1.y)),e.lineTo(n(t.p2.x),a(t.p2.y)),e.lineTo(n(t.p3.x),a(t.p3.y)),e.lineTo(n(t.p4.x),a(t.p4.y)),e.lineTo(n(t.p1.x),a(t.p1.y)),e.stroke(),e.fill(),t.isShowBodyText){e.fillStyle=t.colorTextLegend;const l=t.isHorizontalFlipped?"( ⇆ )":"",o=t.isVerticalFlipped?"( ⇅ )":"",r=Oe(t.square),w=` S=${r} м² ${l} ${o}`;if(t.name===Ve.REMAINS&&r>0){const d=t.wP1P2>=t.wP3P4?n(t.p1.x)+10:n(t.p4.x),c=t.wP1P2>=t.wP3P4?a(t.h)/2-10:a(t.h)+50,m={x:d,y:c};e.fillText(w,m.x,m.y),e.setLineDash([5,3]),e.beginPath(),t.wP1P2>=t.wP3P4?(e.moveTo(m.x,m.y),e.lineTo(n(t.p1.x+40),a(t.p1.y))):(e.moveTo(m.x+10,m.y-10),e.lineTo(n(t.p4.x+40),a(t.p4.y))),e.stroke(),e.closePath()}else{const d=(n(t.p2.x)+n(t.p1.x))/2-w.length*2,c=(n(t.p3.x)+n(t.p4.x))/2,m={x:2*d*c/(d+c),y:a(t.h)/2+t.halfYBoard/2};e.fillText(w,m.x,m.y)}e.closePath()}s(t,e)}function Kn(t){for(;t!=null&&t.firstChild&&t.lastChild;)t.removeChild(t.lastChild)}function Ln(t,e,n,a){const i=o=>new Ye({name:"rawPiece",square:o.square,p1:{x:0,y:0},p2:{x:o.size.a,y:0},p3:{x:o.size.a,y:o.size.h},p4:{x:0,y:o.size.h},wP1P2:o.size.a,wP2P3:o.size.b,wP3P4:o.size.c,wP4P1:o.size.d,h:o.size.h,colorBody:"lightgray",isShowBodyText:!1,isShowSideContour:!1,baseSpace:60,halfXBoard:0,halfYBoard:100,wDivider:4.2,hDivider:5}),s=(o,r)=>{o.beginPath(),o.font=" 14pt Arial",o.fillStyle="black";const w=r.volume?" (x"+r.volume+")":"",d=r.combination.filter(c=>c.name!==Ve.REMAINS&&c.name!==Ve.STOCK).length;o.fillText(`Вариант №${r.num}${w}.  Деталей ${d}`,20,20),o.stroke(),o.fill(),o.closePath()},l=document.getElementById(t);l&&(Kn(l),console.log("listDrawCombinations--",a),a.forEach(o=>{const r=Gn(l);s(r,o),Wt(i(n),r),o.combination.forEach(w=>{Wt(w,r)})}))}function Oi(t,e){const n=document.getElementById(t);if(n){Kn(n);const a=Gn(n,600,250),i={x:0,y:0},s={x:i.x+e.size.a,y:0},l={x:s.x,y:e.size.h},o=e.isRect?l:Yt(s.x,s.y,l.y,e.size.b,e.size.differenceBases),r={x:o.x-e.size.c,y:o.y},w=new Ye({name:e.name,square:e.square,p1:i,p2:s,p3:o,p4:r,wP1P2:e.size.a,wP2P3:e.size.b,wP3P4:e.size.c,wP4P1:e.size.d,h:e.size.h,isHorizontalFlipped:e.isHorizontalFlipped,isVerticalFlipped:e.isVerticalFlipped,wDivider:4,hDivider:5});Wt(w,a)}}function Nn(t,e,n){const a=t.slice();return a[25]=e[n],a[26]=e,a[27]=n,a}function On(t){let e,n,a=t[27]+1+"",i,s,l,o,r,w,d,c,m,h,p,u,_,D,S,k,F,I,M,G,ie,Q,se,$,C,B,L,q,Ge,ve,re,fe,Ke,oe,ae,we,ze,de,_e;function X(A){t[12](A,t[25])}let ye={type:"text",id:"namePiece",placeholder:"Наименования детали..."};t[25].blank.name!==void 0&&(ye.value=t[25].blank.name),o=new Re({props:ye}),ge.push(()=>me(o,"value",X));function mt(A){t[13](A,t[25])}let $e={type:"number",numSettings:{min:t[25].blank.size.minLength,max:t[25].blank.size.maxLength},id:"lengthAPiece",placeholder:"Длина верхнего основания детали..."};t[25].blank.size.a!==void 0&&($e.value=t[25].blank.size.a),c=new Re({props:$e}),ge.push(()=>me(c,"value",mt));function ke(A){t[14](A,t[25])}let je={id:"lengthBPiece",type:"number",numSettings:{min:t[25].blank.size.minLength,max:t[25].blank.size.maxLength},disabled:!0,placeholder:"Длина правой стороны детали..."};t[25].blank.size.b!==void 0&&(je.value=t[25].blank.size.b),u=new Re({props:je}),ge.push(()=>me(u,"value",ke));function pt(A){t[15](A,t[25])}let xe={id:"lengthCPiece",type:"number",numSettings:{min:t[25].blank.size.minLength,max:t[25].blank.size.maxLength},placeholder:"Длина нижнего основания детали..."};t[25].blank.size.c!==void 0&&(xe.value=t[25].blank.size.c),k=new Re({props:xe}),ge.push(()=>me(k,"value",pt));function wt(A){t[16](A,t[25])}let et={id:"lengthDPiece",type:"number",disabled:!0,numSettings:{min:t[25].blank.size.minLength,max:t[25].blank.size.maxLength},placeholder:"Длина левой стороны детали..."};t[25].blank.size.d!==void 0&&(et.value=t[25].blank.size.d),G=new Re({props:et}),ge.push(()=>me(G,"value",wt));function Ee(A){t[17](A,t[25])}let tt={id:"leftDownAngle",type:"number",numSettings:{min:t[25].blank.size.minAngle,max:t[25].blank.size.maxAngle},placeholder:"Левый угол при нижнем основании детали..."};t[25].blank.size.leftDownAngle!==void 0&&(tt.value=t[25].blank.size.leftDownAngle),$=new Re({props:tt}),ge.push(()=>me($,"value",Ee));function _t(A){t[18](A,t[25])}let De={id:"rightDownAngle",type:"number",disabled:!0,numSettings:{min:t[25].blank.size.minAngle,max:t[25].blank.size.maxAngle},placeholder:"Правый угол при нижнем основании детали..."};t[25].blank.size.rightDownAngle!==void 0&&(De.value=t[25].blank.size.rightDownAngle),q=new Re({props:De}),ge.push(()=>me(q,"value",_t));function bt(A){t[19](A,t[25])}let nt={id:"volumePiece",type:"number",numSettings:{min:t[25].minVolume,max:t[25].maxVolume},placeholder:"Количество деталей данного типа..."};return t[25].volume!==void 0&&(nt.value=t[25].volume),fe=new Re({props:nt}),ge.push(()=>me(fe,"value",bt)),{c(){e=v("tr"),n=v("th"),i=ee(a),s=T(),l=v("td"),K(o.$$.fragment),w=T(),d=v("td"),K(c.$$.fragment),h=T(),p=v("td"),K(u.$$.fragment),D=T(),S=v("td"),K(k.$$.fragment),I=T(),M=v("td"),K(G.$$.fragment),Q=T(),se=v("td"),K($.$$.fragment),B=T(),L=v("td"),K(q.$$.fragment),ve=T(),re=v("td"),K(fe.$$.fragment),oe=T(),ae=v("tr"),we=v("td"),ze=v("div"),de=T(),this.h()},l(A){e=z(A,"TR",{class:!0});var E=y(e);n=z(E,"TH",{scope:!0,class:!0});var Ie=y(n);i=te(Ie,a),Ie.forEach(b),s=R(E),l=z(E,"TD",{class:!0});var ce=y(l);W(o.$$.fragment,ce),ce.forEach(b),w=R(E),d=z(E,"TD",{class:!0});var Ce=y(d);W(c.$$.fragment,Ce),Ce.forEach(b),h=R(E),p=z(E,"TD",{class:!0});var Pe=y(p);W(u.$$.fragment,Pe),Pe.forEach(b),D=R(E),S=z(E,"TD",{class:!0});var ue=y(S);W(k.$$.fragment,ue),ue.forEach(b),I=R(E),M=z(E,"TD",{class:!0});var Se=y(M);W(G.$$.fragment,Se),Se.forEach(b),Q=R(E),se=z(E,"TD",{class:!0});var Ae=y(se);W($.$$.fragment,Ae),Ae.forEach(b),B=R(E),L=z(E,"TD",{class:!0});var he=y(L);W(q.$$.fragment,he),he.forEach(b),ve=R(E),re=z(E,"TD",{class:!0});var it=y(re);W(fe.$$.fragment,it),it.forEach(b),E.forEach(b),oe=R(A),ae=z(A,"TR",{class:!0});var We=y(ae);we=z(We,"TD",{class:!0,colspan:!0});var Te=y(we);ze=z(Te,"DIV",{id:!0,class:!0}),y(ze).forEach(b),Te.forEach(b),de=R(We),We.forEach(b),this.h()},h(){f(n,"scope","row"),f(n,"class","px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white"),f(l,"class","min-w-[150px] pr-6 py-4 border-r"),f(d,"class","px-6 py-4"),f(p,"class","px-6 py-4"),f(S,"class","px-6 py-4"),f(M,"class","px-6 py-4"),f(se,"class","px-6 py-4"),f(L,"class","px-6 py-4"),f(re,"class","w-[20px] border-l px-6 py-4"),f(e,"class","bg-white border-b dark:bg-gray-700 dark:border-gray-600 hover:bg-[gray]/5 dark:hover:bg-gray-600"),f(ze,"id","containerPieceCanvas"+t[27]),f(ze,"class","flex flex-col"),f(we,"class","px-6 py-4"),f(we,"colspan","200"),f(ae,"class","bg-white border-b dark:bg-gray-700 dark:border-gray-600 hover:bg-[gray]/5 dark:hover:bg-gray-600")},m(A,E){le(A,e,E),g(e,n),g(n,i),g(e,s),g(e,l),Z(o,l,null),g(e,w),g(e,d),Z(c,d,null),g(e,h),g(e,p),Z(u,p,null),g(e,D),g(e,S),Z(k,S,null),g(e,I),g(e,M),Z(G,M,null),g(e,Q),g(e,se),Z($,se,null),g(e,B),g(e,L),Z(q,L,null),g(e,ve),g(e,re),Z(fe,re,null),le(A,oe,E),le(A,ae,E),g(ae,we),g(we,ze),g(ae,de),_e=!0},p(A,E){t=A;const Ie={};!r&&E&2&&(r=!0,Ie.value=t[25].blank.name,pe(()=>r=!1)),o.$set(Ie);const ce={};E&2&&(ce.numSettings={min:t[25].blank.size.minLength,max:t[25].blank.size.maxLength}),!m&&E&2&&(m=!0,ce.value=t[25].blank.size.a,pe(()=>m=!1)),c.$set(ce);const Ce={};E&2&&(Ce.numSettings={min:t[25].blank.size.minLength,max:t[25].blank.size.maxLength}),!_&&E&2&&(_=!0,Ce.value=t[25].blank.size.b,pe(()=>_=!1)),u.$set(Ce);const Pe={};E&2&&(Pe.numSettings={min:t[25].blank.size.minLength,max:t[25].blank.size.maxLength}),!F&&E&2&&(F=!0,Pe.value=t[25].blank.size.c,pe(()=>F=!1)),k.$set(Pe);const ue={};E&2&&(ue.numSettings={min:t[25].blank.size.minLength,max:t[25].blank.size.maxLength}),!ie&&E&2&&(ie=!0,ue.value=t[25].blank.size.d,pe(()=>ie=!1)),G.$set(ue);const Se={};E&2&&(Se.numSettings={min:t[25].blank.size.minAngle,max:t[25].blank.size.maxAngle}),!C&&E&2&&(C=!0,Se.value=t[25].blank.size.leftDownAngle,pe(()=>C=!1)),$.$set(Se);const Ae={};E&2&&(Ae.numSettings={min:t[25].blank.size.minAngle,max:t[25].blank.size.maxAngle}),!Ge&&E&2&&(Ge=!0,Ae.value=t[25].blank.size.rightDownAngle,pe(()=>Ge=!1)),q.$set(Ae);const he={};E&2&&(he.numSettings={min:t[25].minVolume,max:t[25].maxVolume}),!Ke&&E&2&&(Ke=!0,he.value=t[25].volume,pe(()=>Ke=!1)),fe.$set(he)},i(A){_e||(U(o.$$.fragment,A),U(c.$$.fragment,A),U(u.$$.fragment,A),U(k.$$.fragment,A),U(G.$$.fragment,A),U($.$$.fragment,A),U(q.$$.fragment,A),U(fe.$$.fragment,A),_e=!0)},o(A){Y(o.$$.fragment,A),Y(c.$$.fragment,A),Y(u.$$.fragment,A),Y(k.$$.fragment,A),Y(G.$$.fragment,A),Y($.$$.fragment,A),Y(q.$$.fragment,A),Y(fe.$$.fragment,A),_e=!1},d(A){A&&b(e),J(o),J(c),J(u),J(k),J(G),J($),J(q),J(fe),A&&b(oe),A&&b(ae)}}}function Mi(t){let e;return{c(){e=v("div"),this.h()},l(n){e=z(n,"DIV",{id:!0,class:!0}),y(e).forEach(b),this.h()},h(){f(e,"id","containerWorkPieceCanvas"),f(e,"class","flex flex-col")},m(n,a){le(n,e,a)},p:Ue,d(n){n&&b(e)}}}function Xi(t){let e,n,a;return{c(){e=v("div"),this.h()},l(i){e=z(i,"DIV",{id:!0,contenteditable:!0}),y(e).forEach(b),this.h()},h(){f(e,"id","log"),f(e,"contenteditable","true"),t[3]===void 0&&Un(()=>t[20].call(e))},m(i,s){le(i,e,s),t[3]!==void 0&&(e.innerHTML=t[3]),n||(a=ht(e,"input",t[20]),n=!0)},p(i,s){s&8&&i[3]!==e.innerHTML&&(e.innerHTML=i[3])},d(i){i&&b(e),n=!1,a()}}}function Ui(t){let e,n,a;return{c(){e=v("div"),this.h()},l(i){e=z(i,"DIV",{id:!0,contenteditable:!0}),y(e).forEach(b),this.h()},h(){f(e,"id","shortLog"),f(e,"contenteditable","true"),t[4]===void 0&&Un(()=>t[21].call(e))},m(i,s){le(i,e,s),t[4]!==void 0&&(e.innerHTML=t[4]),n||(a=ht(e,"input",t[21]),n=!0)},p(i,s){s&16&&i[4]!==e.innerHTML&&(e.innerHTML=i[4])},d(i){i&&b(e),n=!1,a()}}}function Yi(t){let e;return{c(){e=v("div"),this.h()},l(n){e=z(n,"DIV",{id:!0,class:!0}),y(e).forEach(b),this.h()},h(){f(e,"id","containerOptimumCombinationsCanvas"),f(e,"class","flex flex-col")},m(n,a){le(n,e,a)},p:Ue,d(n){n&&b(e)}}}function Gi(t){let e,n,a,i,s,l,o,r,w,d,c,m,h,p,u,_,D,S,k,F,I,M,G,ie,Q,se,$,C,B,L,q,Ge,ve,re,fe,Ke,oe,ae,we,ze,de,_e,X,ye,mt,$e,ke,je,pt,xe,wt,et,Ee,tt,_t,De,bt,nt,A,E,Ie,ce,Ce,Pe,ue,Se,Ae,he,it,We,Te,It,Ze,Tt,Rt,st,qe,Bt,Ct,Vt,ot,qt,Ht,at,He,Lt,lt,Le,Nt,rt,Ne,Pt,Ot,$t;function Wn(P){t[8](P)}let jt={label:"Имя",id:"nameWorkPiece",type:"text",placeholder:"Имя исходной заготовки...",required:!0};t[0].name!==void 0&&(jt.value=t[0].name),p=new kt({props:jt}),ge.push(()=>me(p,"value",Wn)),S=new kt({props:{label:"Длина, мм.",id:"lengthRawPiece",type:"number",placeholder:"Длина исходной заготовки(в миллиметрах)...",value:t[0].size.a,onChange:t[9],required:!0}});function Zn(P){t[10](P)}let en={label:"Ширина (h), мм.",id:"widthRawPiece",type:"number",placeholder:"Ширина исходной заготовки (в миллиметрах)...",required:!0};t[0].size.h!==void 0&&(en.value=t[0].size.h),I=new kt({props:en}),ge.push(()=>me(I,"value",Zn));function Jn(P){t[11](P)}let tn={label:"Припуск, мм.",id:"restrictedParams.stockSawing",type:"number",placeholder:"Припуск при распиле (в миллиметрах)...",required:!0};t[2].stockSawing!==void 0&&(tn.value=t[2].stockSawing),Q=new kt({props:tn}),ge.push(()=>me(Q,"value",Jn)),q=new mi({props:{src:bi,class:"max-h-72 m-auto"}});let Je=t[1],N=[];for(let P=0;P<Je.length;P+=1)N[P]=On(Nn(t,Je,P));const Qn=P=>Y(N[P],1,1,()=>{N[P]=null});return qe=new At({props:{title:"Варианты раскроя",isOpen:!0,$$slots:{default:[Mi]},$$scope:{ctx:t}}}),He=new At({props:{title:"Результаты вычислений",$$slots:{default:[Xi]},$$scope:{ctx:t}}}),Le=new At({props:{title:"Краткие результаты",isOpen:!0,$$slots:{default:[Ui]},$$scope:{ctx:t}}}),Ne=new At({props:{title:"Оптимальные варианты раскроя",isOpen:!0,$$slots:{default:[Yi]},$$scope:{ctx:t}}}),{c(){e=v("div"),n=v("div"),a=v("main"),i=v("div"),s=v("div"),l=v("section"),o=v("div"),r=v("h2"),w=ee("Параметры исходной заготовки для распила"),d=T(),c=v("form"),m=v("div"),h=v("div"),K(p.$$.fragment),_=T(),D=v("div"),K(S.$$.fragment),k=T(),F=v("div"),K(I.$$.fragment),G=T(),ie=v("div"),K(Q.$$.fragment),$=T(),C=v("h2"),B=ee("Схема детали"),L=T(),K(q.$$.fragment),Ge=T(),ve=v("div"),re=v("button"),fe=ee("Запустить расчет"),Ke=T(),oe=v("div"),ae=v("h2"),we=ee("Список требуемых деталей из заказа"),ze=T(),de=v("table"),_e=v("thead"),X=v("tr"),ye=v("th"),mt=ee("№"),$e=T(),ke=v("th"),je=ee("Имя"),pt=T(),xe=v("th"),wt=ee("Длина верхнего основания (a), мм."),et=T(),Ee=v("th"),tt=ee("Длина правой стороны (b), мм."),_t=T(),De=v("th"),bt=ee("Длина нижнего основания (c), мм."),nt=T(),A=v("th"),E=ee("Длина левой стороны (d), мм."),Ie=T(),ce=v("th"),Ce=ee("Левый угол при нижнем основании (f), °"),Pe=T(),ue=v("th"),Se=ee("Правый угол при нижнем основании (e), °"),Ae=T(),he=v("th"),it=ee("Количество, шт."),We=T(),Te=v("tbody");for(let P=0;P<N.length;P+=1)N[P].c();It=T(),Ze=v("button"),Tt=ee("+ Добавить деталь"),Rt=T(),st=v("div"),K(qe.$$.fragment),Bt=T(),Ct=v("hr"),Vt=T(),ot=v("h2"),qt=ee("Результаты"),Ht=T(),at=v("div"),K(He.$$.fragment),Lt=T(),lt=v("div"),K(Le.$$.fragment),Nt=T(),rt=v("div"),K(Ne.$$.fragment),this.h()},l(P){e=z(P,"DIV",{class:!0});var V=y(e);n=z(V,"DIV",{class:!0});var Fe=y(n);a=z(Fe,"MAIN",{class:!0});var ct=y(a);i=z(ct,"DIV",{class:!0});var vt=y(i);s=z(vt,"DIV",{class:!0});var H=y(s);l=z(H,"SECTION",{class:!0});var zt=y(l);o=z(zt,"DIV",{class:!0});var Qe=y(o);r=z(Qe,"H2",{class:!0});var yt=y(r);w=te(yt,"Параметры исходной заготовки для распила"),yt.forEach(b),d=R(Qe),c=z(Qe,"FORM",{action:!0});var xt=y(c);m=z(xt,"DIV",{class:!0});var O=y(m);h=z(O,"DIV",{class:!0});var Dt=y(h);W(p.$$.fragment,Dt),Dt.forEach(b),_=R(O),D=z(O,"DIV",{class:!0});var nn=y(D);W(S.$$.fragment,nn),nn.forEach(b),k=R(O),F=z(O,"DIV",{class:!0});var sn=y(F);W(I.$$.fragment,sn),sn.forEach(b),G=R(O),ie=z(O,"DIV",{class:!0});var on=y(ie);W(Q.$$.fragment,on),on.forEach(b),O.forEach(b),xt.forEach(b),Qe.forEach(b),zt.forEach(b),$=R(H),C=z(H,"H2",{class:!0});var an=y(C);B=te(an,"Схема детали"),an.forEach(b),L=R(H),W(q.$$.fragment,H),Ge=R(H),ve=z(H,"DIV",{class:!0});var ln=y(ve);re=z(ln,"BUTTON",{class:!0});var rn=y(re);fe=te(rn,"Запустить расчет"),rn.forEach(b),ln.forEach(b),Ke=R(H),oe=z(H,"DIV",{class:!0});var ut=y(oe);ae=z(ut,"H2",{class:!0});var cn=y(ae);we=te(cn,"Список требуемых деталей из заказа"),cn.forEach(b),ze=R(ut),de=z(ut,"TABLE",{class:!0});var St=y(de);_e=z(St,"THEAD",{class:!0});var un=y(_e);X=z(un,"TR",{});var j=y(X);ye=z(j,"TH",{scope:!0,class:!0});var hn=y(ye);mt=te(hn,"№"),hn.forEach(b),$e=R(j),ke=z(j,"TH",{scope:!0,class:!0});var fn=y(ke);je=te(fn,"Имя"),fn.forEach(b),pt=R(j),xe=z(j,"TH",{scope:!0,class:!0});var dn=y(xe);wt=te(dn,"Длина верхнего основания (a), мм."),dn.forEach(b),et=R(j),Ee=z(j,"TH",{scope:!0,class:!0});var gn=y(Ee);tt=te(gn,"Длина правой стороны (b), мм."),gn.forEach(b),_t=R(j),De=z(j,"TH",{scope:!0,class:!0});var mn=y(De);bt=te(mn,"Длина нижнего основания (c), мм."),mn.forEach(b),nt=R(j),A=z(j,"TH",{scope:!0,class:!0});var pn=y(A);E=te(pn,"Длина левой стороны (d), мм."),pn.forEach(b),Ie=R(j),ce=z(j,"TH",{scope:!0,class:!0});var wn=y(ce);Ce=te(wn,"Левый угол при нижнем основании (f), °"),wn.forEach(b),Pe=R(j),ue=z(j,"TH",{scope:!0,class:!0});var _n=y(ue);Se=te(_n,"Правый угол при нижнем основании (e), °"),_n.forEach(b),Ae=R(j),he=z(j,"TH",{scope:!0,class:!0});var bn=y(he);it=te(bn,"Количество, шт."),bn.forEach(b),j.forEach(b),un.forEach(b),We=R(St),Te=z(St,"TBODY",{});var vn=y(Te);for(let Mt=0;Mt<N.length;Mt+=1)N[Mt].l(vn);vn.forEach(b),St.forEach(b),It=R(ut),Ze=z(ut,"BUTTON",{class:!0});var zn=y(Ze);Tt=te(zn,"+ Добавить деталь"),zn.forEach(b),ut.forEach(b),Rt=R(H),st=z(H,"DIV",{class:!0});var yn=y(st);W(qe.$$.fragment,yn),yn.forEach(b),Bt=R(H),Ct=z(H,"HR",{class:!0}),Vt=R(H),ot=z(H,"H2",{class:!0});var xn=y(ot);qt=te(xn,"Результаты"),xn.forEach(b),Ht=R(H),at=z(H,"DIV",{class:!0});var Dn=y(at);W(He.$$.fragment,Dn),Dn.forEach(b),Lt=R(H),lt=z(H,"DIV",{class:!0});var Cn=y(lt);W(Le.$$.fragment,Cn),Cn.forEach(b),Nt=R(H),rt=z(H,"DIV",{class:!0});var Pn=y(rt);W(Ne.$$.fragment,Pn),Pn.forEach(b),H.forEach(b),vt.forEach(b),ct.forEach(b),Fe.forEach(b),V.forEach(b),this.h()},h(){f(r,"class","mb-4 text-xl font-bold text-gray-900 dark:text-white"),f(h,"class","sm:col-span-2"),f(D,"class","w-full"),f(F,"class","w-full"),f(ie,"class","w-full"),f(m,"class","grid gap-4 sm:grid-cols-2 sm:gap-6"),f(c,"action","#"),f(o,"class","py-8 px-4 mx-auto max-w-2xl lg:py-16"),f(l,"class","bg-white dark:bg-gray-900"),f(C,"class","mb-4 text-xl font-bold text-gray-900 dark:text-white"),f(re,"class","inline-flex items-center px-5 py-2.5 mt-4 sm:mt-6 text-sm font-medium text-center float-right text-white bg-primary-600 rounded-lg focus:ring-4 focus:ring-primary-200 dark:focus:ring-primary-900 hover:bg-primary-700"),f(ve,"class","relative overflow-x-auto"),f(ae,"class","mb-4 text-xl font-bold text-gray-900 dark:text-white"),f(ye,"scope","col"),f(ye,"class","px-6 py-3"),f(ke,"scope","col"),f(ke,"class","px-6 py-3"),f(xe,"scope","col"),f(xe,"class","px-6 py-3"),f(Ee,"scope","col"),f(Ee,"class","px-6 py-3"),f(De,"scope","col"),f(De,"class","px-6 py-3"),f(A,"scope","col"),f(A,"class","px-6 py-3"),f(ce,"scope","col"),f(ce,"class","px-6 py-3"),f(ue,"scope","col"),f(ue,"class","px-6 py-3"),f(he,"scope","col"),f(he,"class","px-6 py-3"),f(_e,"class","text-xs text-gray-600 uppercase bg-gray-50 dark:bg-gray-600 dark:text-gray-400"),f(de,"class","w-full text-sm text-left text-gray-500 dark:text-gray-400"),f(Ze,"class","inline-flex items-center px-5 py-2.5 mt-4 sm:mt-6 text-sm font-medium text-center float-right text-white bg-primary-600 rounded-lg focus:ring-4 focus:ring-primary-200 dark:focus:ring-primary-900 hover:bg-primary-700"),f(oe,"class","relative overflow-x-auto"),f(st,"class","mt-5"),f(Ct,"class","my-10"),f(ot,"class","mb-4 text-xl font-bold text-gray-900 dark:text-white"),f(at,"class","mt-5"),f(lt,"class","mt-5"),f(rt,"class","mt-5"),f(s,"class","flex-auto max-w-8xl min-w-0 pt-6 lg:px-8 lg:pt-8 pb:12 xl:pb-24 lg:pb-16"),f(i,"class","flex w-full"),f(a,"class","flex-auto w-full min-w-0 lg:static lg:max-h-full lg:overflow-visible"),f(n,"class","lg:flex"),f(e,"class","w-full px-4 mx-auto max-w-8xl")},m(P,V){le(P,e,V),g(e,n),g(n,a),g(a,i),g(i,s),g(s,l),g(l,o),g(o,r),g(r,w),g(o,d),g(o,c),g(c,m),g(m,h),Z(p,h,null),g(m,_),g(m,D),Z(S,D,null),g(m,k),g(m,F),Z(I,F,null),g(m,G),g(m,ie),Z(Q,ie,null),g(s,$),g(s,C),g(C,B),g(s,L),Z(q,s,null),g(s,Ge),g(s,ve),g(ve,re),g(re,fe),g(s,Ke),g(s,oe),g(oe,ae),g(ae,we),g(oe,ze),g(oe,de),g(de,_e),g(_e,X),g(X,ye),g(ye,mt),g(X,$e),g(X,ke),g(ke,je),g(X,pt),g(X,xe),g(xe,wt),g(X,et),g(X,Ee),g(Ee,tt),g(X,_t),g(X,De),g(De,bt),g(X,nt),g(X,A),g(A,E),g(X,Ie),g(X,ce),g(ce,Ce),g(X,Pe),g(X,ue),g(ue,Se),g(X,Ae),g(X,he),g(he,it),g(de,We),g(de,Te);for(let Fe=0;Fe<N.length;Fe+=1)N[Fe]&&N[Fe].m(Te,null);g(oe,It),g(oe,Ze),g(Ze,Tt),g(s,Rt),g(s,st),Z(qe,st,null),g(s,Bt),g(s,Ct),g(s,Vt),g(s,ot),g(ot,qt),g(s,Ht),g(s,at),Z(He,at,null),g(s,Lt),g(s,lt),Z(Le,lt,null),g(s,Nt),g(s,rt),Z(Ne,rt,null),Pt=!0,Ot||($t=[ht(re,"click",t[5]),ht(Ze,"click",t[6])],Ot=!0)},p(P,[V]){const Fe={};!u&&V&1&&(u=!0,Fe.value=P[0].name,pe(()=>u=!1)),p.$set(Fe);const ct={};V&1&&(ct.value=P[0].size.a),V&1&&(ct.onChange=P[9]),S.$set(ct);const vt={};!M&&V&1&&(M=!0,vt.value=P[0].size.h,pe(()=>M=!1)),I.$set(vt);const H={};if(!se&&V&4&&(se=!0,H.value=P[2].stockSawing,pe(()=>se=!1)),Q.$set(H),V&2){Je=P[1];let O;for(O=0;O<Je.length;O+=1){const Dt=Nn(P,Je,O);N[O]?(N[O].p(Dt,V),U(N[O],1)):(N[O]=On(Dt),N[O].c(),U(N[O],1),N[O].m(Te,null))}for(ui(),O=Je.length;O<N.length;O+=1)Qn(O);ai()}const zt={};V&268435456&&(zt.$$scope={dirty:V,ctx:P}),qe.$set(zt);const Qe={};V&268435464&&(Qe.$$scope={dirty:V,ctx:P}),He.$set(Qe);const yt={};V&268435472&&(yt.$$scope={dirty:V,ctx:P}),Le.$set(yt);const xt={};V&268435456&&(xt.$$scope={dirty:V,ctx:P}),Ne.$set(xt)},i(P){if(!Pt){U(p.$$.fragment,P),U(S.$$.fragment,P),U(I.$$.fragment,P),U(Q.$$.fragment,P),U(q.$$.fragment,P);for(let V=0;V<Je.length;V+=1)U(N[V]);U(qe.$$.fragment,P),U(He.$$.fragment,P),U(Le.$$.fragment,P),U(Ne.$$.fragment,P),Pt=!0}},o(P){Y(p.$$.fragment,P),Y(S.$$.fragment,P),Y(I.$$.fragment,P),Y(Q.$$.fragment,P),Y(q.$$.fragment,P),N=N.filter(Boolean);for(let V=0;V<N.length;V+=1)Y(N[V]);Y(qe.$$.fragment,P),Y(He.$$.fragment,P),Y(Le.$$.fragment,P),Y(Ne.$$.fragment,P),Pt=!1},d(P){P&&b(e),J(p),J(S),J(I),J(Q),J(q),li(N,P),J(qe),J(He),J(Le),J(Ne),Ot=!1,Xn($t)}}}function Ki(t,e,n){let{data:a}=e,i=a.rawWorkPiece,s=a.restrictedParams,l=[],o,r="",w="";const d=C=>{const B=[],L=q=>q.volume>0&&q.blank.size.a>0&&q.blank.size.c>0;return C.forEach(q=>{q.blank.size.h=i.size.h,L(q)&&B.push(q)}),B},c=()=>{l==null||l.forEach((C,B)=>{Oi(`containerPieceCanvas${B}`,C.blank)})};ri(()=>{console.log("afterUpdate"),c()});const m=()=>{if(s.stockSawing>=0&&i.name.length>0&&i.size.a&&i.size.c&&i.size.h){n(1,l=d(l));const C=new Tn({id:ne(),type:"info",text:"Расчет запущен!"});if(Rn.add(Bn(C)),l.length){o=Bi({stockSawing:s.stockSawing,rawWorkPiece:i,listOrders:l}),console.log(o),Ln("containerWorkPieceCanvas",s.stockSawing,i,o.drawCombinations),Ln("containerOptimumCombinationsCanvas",s.stockSawing,i,o.optimumDrawCombinations);const B=new Tn({id:ne(),type:"success",text:"Расчет завершен!"});Rn.add(Bn(B)),n(4,w=o.listLogMessages.slice(o.listLogMessages.findLastIndex(L=>L.includes("Результаты вычисления задачи поиска решения оптимального раскроя")),o.listLogMessages.findLastIndex(L=>L.includes("Остатки: "))+1).map(L=>L.includes("===>")?`<p class='mt-2 font-bold'>${L}</p>`:`<p '>${L}</p>`).join("")),n(3,r=o.listLogMessages.map(L=>L.includes("===>")?`<p class='mt-2 font-bold'>${L}</p>`:`<p '>${L}</p>`).join(""))}else alert("Внимание! Нет валидных деталей для выполнения алгоритма. Скорее всего не все поля были заполнены.")}else alert("Внимание! Некорректно заполнены параметры исходной заготовки.")},h=()=>{};ci(()=>{console.log(a),n(2,s=a.restrictedParams),n(0,i=new be(a.rawWorkPiece)),n(1,l=a.rawOrders.map(C=>new Vn(C))),setTimeout(()=>{c()},100),m()});function p(C){t.$$.not_equal(i.name,C)&&(i.name=C,n(0,i))}const u=C=>i.size.changeBothBases(C);function _(C){t.$$.not_equal(i.size.h,C)&&(i.size.h=C,n(0,i))}function D(C){t.$$.not_equal(s.stockSawing,C)&&(s.stockSawing=C,n(2,s))}function S(C,B){t.$$.not_equal(B.blank.name,C)&&(B.blank.name=C,n(1,l),n(0,i))}function k(C,B){t.$$.not_equal(B.blank.size.a,C)&&(B.blank.size.a=C,n(1,l),n(0,i))}function F(C,B){t.$$.not_equal(B.blank.size.b,C)&&(B.blank.size.b=C,n(1,l),n(0,i))}function I(C,B){t.$$.not_equal(B.blank.size.c,C)&&(B.blank.size.c=C,n(1,l),n(0,i))}function M(C,B){t.$$.not_equal(B.blank.size.d,C)&&(B.blank.size.d=C,n(1,l),n(0,i))}function G(C,B){t.$$.not_equal(B.blank.size.leftDownAngle,C)&&(B.blank.size.leftDownAngle=C,n(1,l),n(0,i))}function ie(C,B){t.$$.not_equal(B.blank.size.rightDownAngle,C)&&(B.blank.size.rightDownAngle=C,n(1,l),n(0,i))}function Q(C,B){t.$$.not_equal(B.volume,C)&&(B.volume=C,n(1,l),n(0,i))}function se(){r=this.innerHTML,n(3,r)}function $(){w=this.innerHTML,n(4,w)}return t.$$set=C=>{"data"in C&&n(7,a=C.data)},t.$$.update=()=>{t.$$.dirty&3&&i.size.h&&(console.log("rawWorkPiece.size.h"),console.log("rawWorkPiece.size.h"),n(1,l=l.map(C=>(C.blank.size.h=i.size.h,new Vn(C)))))},[i,l,s,r,w,m,h,a,p,u,_,D,S,k,F,I,M,G,ie,Q,se,$]}class $i extends ft{constructor(e){super(),dt(this,e,Ki,Gi,gt,{data:7})}}export{$i as component,Qi as universal};
